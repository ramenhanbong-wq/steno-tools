<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>ì•„ì¹´ë°ë¯¸ ì„±ê³¼ ë¶„ì„ í”„ë¡œ(Pro) - í†µí•© ì™„ì„±íŒ (+í‚¤ë³´ë“œ ì—°ë ¹ íŒ¨ì¹˜)</title>
Â  Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg-cream: #fdfbf7;
Â  Â  Â  Â  Â  Â  --card-white: #ffffff;
Â  Â  Â  Â  Â  Â  --pastel-pink: #ffb7b2;
Â  Â  Â  Â  Â  Â  --pastel-blue: #a2c2ff;
Â  Â  Â  Â  Â  Â  --pastel-mint: #95e1d3;
Â  Â  Â  Â  Â  Â  --text-main: #4a4a4a;
Â  Â  Â  Â  Â  Â  --text-sub: #666666;Â 
Â  Â  Â  Â  Â  Â  --border-line: #f0ebeb;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Gowun Dodum', 'Pretendard', sans-serif;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  background-color: var(--bg-cream);
Â  Â  Â  Â  Â  Â  color: var(--text-main);
Â  Â  Â  Â  Â  Â  padding-top: 90px;
Â  Â  Â  Â  Â  Â  padding-bottom: 50px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- [ë©”ë‰´ë°”] --- */
Â  Â  Â  Â  .navbar {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; left: 0; width: 100%; height: 70px;
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.95);
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: space-between;
Â  Â  Â  Â  Â  Â  padding: 0 30px; box-sizing: border-box; z-index: 1000;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #fff0f0;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(230, 210, 200, 0.1);Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .logo {
Â  Â  Â  Â  Â  Â  font-size: 1.3rem; color: #4a4a4a; text-decoration: none;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 8px; font-weight: bold;
Â  Â  Â  Â  }
Â  Â  Â  Â  .logo i { color: #ff9aa2; font-size: 1.2em; }
Â  Â  Â  Â  .nav-links { display: flex; gap: 8px; }
Â  Â  Â  Â  .nav-item {
Â  Â  Â  Â  Â  Â  text-decoration: none; color: #888; font-weight: 600; padding: 8px 15px;
Â  Â  Â  Â  Â  Â  border-radius: 20px; transition: all 0.3s;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 6px; font-size: 0.95rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item:hover, .nav-item.active {
Â  Â  Â  Â  Â  Â  background-color: #fff0f5; color: #ff6f91; transform: translateY(-2px);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- [ë ˆì´ì•„ì›ƒ] --- */
Â  Â  Â  Â  .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
Â  Â  Â  Â  .header-box { text-align: center; margin-bottom: 30px; }
Â  Â  Â  Â  .header-box h1 { font-size: 2rem; color: #4a4a4a; margin-bottom: 10px; letter-spacing: -1px; }

Â  Â  Â  Â  /* ëª©í‘œ ë‹¬ì„± ê²Œì´ì§€ */
Â  Â  Â  Â  .goal-wrapper {
Â  Â  Â  Â  Â  Â  max-width: 800px; margin: 0 auto 30px auto;
Â  Â  Â  Â  Â  Â  background: #fff; padding: 20px; border-radius: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(0,0,0,0.05);
Â  Â  Â  Â  Â  Â  border: 1px solid #f0ebeb; text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .goal-input-area { margin-bottom: 10px; display: flex; justify-content: center; align-items: center; gap: 10px; }
Â  Â  Â  Â  .goal-input-area input {
Â  Â  Â  Â  Â  Â  padding: 8px 15px; border: 1px solid #ddd; border-radius: 10px;Â 
Â  Â  Â  Â  Â  Â  font-family: 'Pretendard'; font-size: 1rem; width: 120px; text-align: right;
Â  Â  Â  Â  }
Â  Â  Â  Â  .progress-container {
Â  Â  Â  Â  Â  Â  height: 24px; background-color: #f0f0f0; border-radius: 12px; overflow: hidden; position: relative;
Â  Â  Â  Â  }
Â  Â  Â  Â  .progress-bar {
Â  Â  Â  Â  Â  Â  height: 100%; background: linear-gradient(90deg, #a2c2ff, #95e1d3);
Â  Â  Â  Â  Â  Â  width: 0%; transition: width 1s ease-in-out;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: flex-end; padding-right: 10px;
Â  Â  Â  Â  Â  Â  color: white; font-weight: bold; font-size: 0.85rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  .goal-confetti { position: absolute; right: 10px; top: -20px; font-size: 20px; display: none; }

Â  Â  Â  Â  /* ì»¨íŠ¸ë¡¤ ë°” */
Â  Â  Â  Â  .control-bar {Â 
Â  Â  Â  Â  Â  Â  display: flex; justify-content: center; gap: 10px; margin-top: 15px;Â 
Â  Â  Â  Â  Â  Â  background: white; padding: 15px 25px; border-radius: 50px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 20px rgba(200, 200, 200, 0.15);
Â  Â  Â  Â  Â  Â  border: 2px solid #fff0f0;
Â  Â  Â  Â  Â  Â  max-width: 850px; margin-left: auto; margin-right: auto;
Â  Â  Â  Â  Â  Â  align-items: center; flex-wrap: wrap;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-style {
Â  Â  Â  Â  Â  Â  padding: 10px 20px; border-radius: 30px;Â 
Â  Â  Â  Â  Â  Â  font-size: 0.95rem; font-weight: bold; cursor: pointer; border: none;Â 
Â  Â  Â  Â  Â  Â  transition: 0.2s; font-family: 'Gowun Dodum', sans-serif;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 6px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .upload-btn { background: #f0f4ff; color: #5874ff; }
Â  Â  Â  Â  .upload-btn:hover { background: #dce7ff; transform: translateY(-2px); }
Â  Â  Â  Â  .compare-btn { background: #fff0f5; color: #ff6f91; }
Â  Â  Â  Â  .compare-btn:hover { background: #ffe0ea; transform: translateY(-2px); }
Â  Â  Â  Â  .report-btn { background: #e0f7fa; color: #0097a7; }
Â  Â  Â  Â  .report-btn:hover { background: #b2ebf2; transform: translateY(-2px); }
Â  Â  Â  Â  .reset-btn { background: #f5f5f5; color: #666; }
Â  Â  Â  Â  .reset-btn:hover { background: #e0e0e0; transform: translateY(-2px); }

Â  Â  Â  Â  select {Â 
Â  Â  Â  Â  Â  Â  padding: 10px 20px; border-radius: 30px;Â 
Â  Â  Â  Â  Â  Â  border: 2px solid #f0ebeb; font-size: 1rem; cursor: pointer; outline: none;Â 
Â  Â  Â  Â  Â  Â  font-family: 'Gowun Dodum', sans-serif; color: #555; background: #fff;
Â  Â  Â  Â  }
Â  Â  Â  Â  select:hover { border-color: #ffb7b2; }

Â  Â  Â  Â  .section-title {Â 
Â  Â  Â  Â  Â  Â  font-size: 1.4rem; font-weight: bold; margin: 50px 0 20px 0;Â 
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; gap: 10px; color: #333;
Â  Â  Â  Â  }
Â  Â  Â  Â  .section-title::before {
Â  Â  Â  Â  Â  Â  content: ''; display: block; width: 6px; height: 24px;Â 
Â  Â  Â  Â  Â  Â  background: #ffb7b2; border-radius: 3px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- [ì¹´ë“œ ë° ê·¸ë¦¬ë“œ] --- */
Â  Â  Â  Â  .card, .trend-card, .heatmap-container, .kpi-card, .insight-card, .conversion-card {
Â  Â  Â  Â  Â  Â  background: #ffffff; border-radius: 25px; padding: 30px;
Â  Â  Â  Â  Â  Â  border: 2px solid #f0ebeb; box-shadow: 0 8px 20px rgba(200, 200, 200, 0.1);
Â  Â  Â  Â  Â  Â  transition: all 0.3s ease; position: relative;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card:hover, .trend-card:hover, .kpi-card:hover, .insight-card:hover, .conversion-card:hover {
Â  Â  Â  Â  Â  Â  border-color: #ffe0e0; box-shadow: 0 15px 30px rgba(255, 183, 178, 0.2);
Â  Â  Â  Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* KPI & Insight */
Â  Â  Â  Â  .kpi-wrapper { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 20px; }
Â  Â  Â  Â  .kpi-card { text-align: center; cursor: pointer; }
Â  Â  Â  Â  .kpi-label { font-size: 1.1rem; color: #666; margin-bottom: 10px; }
Â  Â  Â  Â  .kpi-amount { font-size: 2rem; font-weight: bold; margin: 5px 0; font-family: 'Pretendard'; }
Â  Â  Â  Â  .total .kpi-amount { color: #8cb6ff; }
Â  Â  Â  Â  .cancel .kpi-amount { color: #ff9aa2; }

Â  Â  Â  Â  .insight-wrapper { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 30px; }
Â  Â  Â  Â  .insight-card { padding: 25px 20px; text-align: center; }
Â  Â  Â  Â  .insight-label { font-size: 0.95rem; color: #999; margin-bottom: 8px; font-family: 'Pretendard'; }
Â  Â  Â  Â  .insight-value { font-size: 1.7rem; font-weight: bold; color: #4a4a4a; margin-bottom: 8px; font-family: 'Pretendard'; }
Â  Â  Â  Â  .insight-desc { font-size: 0.85rem; color: #666; font-family: 'Gowun Dodum'; }
Â  Â  Â  Â  .insight-card.danger { border: 2px solid #ffcfce; background: #fffafa; }
Â  Â  Â  Â  .badge-re { background: #eef2ff; color: #5874ff; padding: 4px 12px; border-radius: 12px; font-size: 0.8rem; font-weight: bold; display: inline-block; margin-top: 5px; }

Â  Â  Â  Â  /* ê·¸ë¦¬ë“œ & í…Œì´ë¸” */
Â  Â  Â  Â  .analysis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 30px; margin-top: 20px; }
Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; font-size: 0.95rem; margin-top: 15px; }
Â  Â  Â  Â  th { background: #fff8f8; color: #666; padding: 12px; text-align: left; border-bottom: 2px solid #ffebeb; font-weight: bold; }
Â  Â  Â  Â  td { padding: 12px; border-bottom: 1px solid #f5f5f5; color: #555; }
Â  Â  Â  Â  tr:hover td { background: #fffcfc; }
Â  Â  Â  Â  .clickable-row { cursor: pointer; color: #8cb6ff; font-weight: bold; text-decoration: none; }
Â  Â  Â  Â  .clickable-row:hover { text-decoration: underline; }

Â  Â  Â  Â  /* íˆíŠ¸ë§µ */
Â  Â  Â  Â  .heatmap-container { overflow-x: auto; padding: 20px; }
Â  Â  Â  Â  .heatmap-table { width: 100%; border-collapse: separate; border-spacing: 6px; }
Â  Â  Â  Â  .heatmap-cell {Â 
Â  Â  Â  Â  Â  Â  text-align: center; padding: 15px 5px; border-radius: 12px;Â 
Â  Â  Â  Â  Â  Â  font-size: 0.9rem; cursor: pointer; border: 1px solid #eee; transition: 0.2s;Â 
Â  Â  Â  Â  Â  Â  font-family: 'Pretendard';
Â  Â  Â  Â  }
Â  Â  Â  Â  .heatmap-cell:hover { transform: scale(1.05); border-color: #ffb7b2 !important; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

Â  Â  Â  Â  /* ì „í™˜ìœ¨ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
Â  Â  Â  Â  .conversion-stats { display: flex; justify-content: space-around; margin-bottom: 20px; }
Â  Â  Â  Â  .conv-stat-box { text-align: center; }
Â  Â  Â  Â  .conv-label { font-size: 0.9rem; color: #888; margin-bottom: 5px; }
Â  Â  Â  Â  .conv-val { font-size: 1.4rem; font-weight: bold; color: #555; font-family: 'Pretendard'; }
Â  Â  Â  Â  .conv-rate { color: #8cb6ff; font-size: 2rem; }

Â  Â  Â  Â  /* ë­í‚¹ ë±ƒì§€ */
Â  Â  Â  Â  .rank-badge {Â 
Â  Â  Â  Â  Â  Â  background: #f0f0f0; color: #666; width: 26px; height: 26px;Â 
Â  Â  Â  Â  Â  Â  border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;Â 
Â  Â  Â  Â  Â  Â  font-size: 12px; font-weight: bold; margin-right: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .rank-1 { background: #ffd700; color: #fff; box-shadow: 0 2px 5px rgba(255, 215, 0, 0.4); }Â 
Â  Â  Â  Â  .rank-2 { background: #c0c0c0; color: #fff; }Â 
Â  Â  Â  Â  .rank-3 { background: #cd7f32; color: #fff; }

Â  Â  Â  Â  /* ëª¨ë‹¬ ê³µí†µ */
Â  Â  Â  Â  .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 2000; backdrop-filter: blur(3px); }
Â  Â  Â  Â  .modal-box {Â 
Â  Â  Â  Â  Â  Â  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);Â 
Â  Â  Â  Â  Â  Â  background: white; width: 500px; max-height: 85vh; border-radius: 25px;Â 
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; padding: 30px;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 50px rgba(0,0,0,0.2); border: 2px solid #fff0f0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid #f0f0f0; padding-bottom: 15px; align-items: center; }
Â  Â  Â  Â  .modal-title { font-size: 1.3rem; font-weight: bold; color: #333; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .student-item { display: flex; justify-content: space-between; padding: 15px 10px; border-bottom: 1px solid #f9f9f9; transition: 0.2s; }
Â  Â  Â  Â  .student-item:hover { background: #fffcfc; border-radius: 10px; }
Â  Â  Â  Â  .badge-partial { font-size: 11px; background: #fff3cd; color: #856404; padding: 3px 8px; border-radius: 10px; margin-left: 5px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* ë¹„êµ ëª¨ë‹¬ ì „ìš© */
Â  Â  Â  Â  .compare-grid-modal { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px; }
Â  Â  Â  Â  .compare-col { background: #fafafa; padding: 15px; border-radius: 15px; text-align: center; }
Â  Â  Â  Â  .compare-val { font-size: 1.5rem; font-weight: bold; font-family: 'Pretendard'; margin: 10px 0; }
Â  Â  Â  Â  .delta-pos { color: #ff6f91; font-weight: bold; }
Â  Â  Â  Â  .delta-neg { color: #8cb6ff; font-weight: bold; }

Â  Â  Â  Â  /* ë³´ê³ ì„œ í…ìŠ¤íŠ¸ ì˜ì—­ */
Â  Â  Â  Â  .report-textarea {
Â  Â  Â  Â  Â  Â  width: 100%; height: 300px; padding: 15px; border: 2px solid #eee; border-radius: 15px;
Â  Â  Â  Â  Â  Â  font-family: 'Pretendard'; font-size: 1rem; line-height: 1.6; resize: none; background: #fafafa; outline: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* LTV ì„¹ì…˜ */
Â  Â  Â  Â  .ltv-card {
Â  Â  Â  Â  Â  Â  background: #fdfdfd; border: 2px dashed #d1d5db; padding: 25px; border-radius: 20px; text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .ltv-stat { font-size: 2rem; font-weight: bold; color: #5874ff; font-family: 'Pretendard'; }

Â  Â  Â  Â  /* ë°˜ì‘í˜• */
Â  Â  Â  Â  @media (max-width: 768px) {
Â  Â  Â  Â  Â  Â  .navbar { padding: 0 15px; height: 60px; }
Â  Â  Â  Â  Â  Â  .logo span, .nav-item span { display: none; }Â 
Â  Â  Â  Â  Â  Â  .logo i, .nav-item i { font-size: 1.2rem; }
Â  Â  Â  Â  Â  Â  .analysis-grid { grid-template-columns: 1fr; }
Â  Â  Â  Â  Â  Â  .control-bar { flex-direction: column; width: 90%; padding: 20px; }
Â  Â  Â  Â  Â  Â  .btn-style, select { width: 100%; justify-content: center; }
Â  Â  Â  Â  Â  Â  .modal-box { width: 90%; }
Â  Â  Â  Â  Â  Â  .compare-grid-modal { grid-template-columns: 1fr; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <nav class="navbar">
Â  Â  Â  Â  <a href="index.html" class="logo">
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-cloud"></i> <span> ì™œ ì¼ì€ í•œë²ˆì— ëª°ë ¤ì˜¤ëŠ” ê±¸ê¹Œìš”? ğŸŒ¸ </span>
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <div class="nav-links">
Â  Â  Â  Â  Â  Â  <a href="index.html" class="nav-item active"><i class="fa-solid fa-house"></i><span>í™ˆ</span></a>
Â  Â  Â  Â  Â  Â  <a href="marker.html" class="nav-item"><i class="fa-solid fa-highlighter"></i><span>ì•½ì–´í‘œì‹œ</span></a>
Â  Â  Â  Â  Â  Â  <a href="splitter.html" class="nav-item"><i class="fa-solid fa-align-left"></i><span>ë¶„í• </span></a>
Â  Â  Â  Â  Â  Â  <a href="money.html" class="nav-item"><i class="fa-solid fa-chart-line"></i><span>ë§¤ì¶œë¶„ì„</span></a>
Â  Â  Â  Â  </div>
Â  Â  </nav>

<div class="container">
Â  Â  <div class="header-box">
Â  Â  Â  Â  <h1>ğŸŒ¸ ì•„ì¹´ë°ë¯¸ ì„±ê³¼ ë¶„ì„ í”„ë¡œ</h1>
Â  Â  Â  Â  <p style="color:#888; margin-top:5px;">ë§¤ì¶œ / PT / ë¬´ë£Œ ì²´í—˜ / <span style="color:#ff6f91; font-weight:bold;">í‚¤ë³´ë“œ êµ¬ë§¤ì</span> í†µí•© ë¶„ì„</p>
Â  Â  </div>

Â  Â  <div class="goal-wrapper">
Â  Â  Â  Â  <div class="goal-input-area">
Â  Â  Â  Â  Â  Â  <span style="font-weight:bold; color:#555;">ğŸ¯ ì´ë²ˆ ë‹¬ ëª©í‘œ ë§¤ì¶œ:</span>
Â  Â  Â  Â  Â  Â  <input type="text" id="targetInput" placeholder="ê¸ˆì•¡ ì…ë ¥" onchange="calculateGoal()" onkeyup="inputNumberFormat(this)"> ì›
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="progress-container">
Â  Â  Â  Â  Â  Â  <div class="progress-bar" id="goalProgressBar">0%</div>
Â  Â  Â  Â  Â  Â  <div class="goal-confetti" id="goalConfetti">ğŸ‰</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="font-size:0.85rem; color:#999; margin-top:5px;">ëª©í‘œë¥¼ ì…ë ¥í•˜ê³  ì—”í„°ë¥¼ ì¹˜ì„¸ìš”!</div>
Â  Â  </div>

Â  Â  <div class="control-bar">
Â  Â  Â  Â  <button class="btn-style upload-btn" onclick="document.getElementById('fileInput').click()">
Â  Â  Â  Â  Â  Â  <i class="fa-regular fa-folder-open"></i> ì—‘ì…€ íŒŒì¼ ì¶”ê°€ (ë‹¤ì¤‘ ì„ íƒ)
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button class="btn-style reset-btn" onclick="resetData()">
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-rotate-right"></i> ì´ˆê¸°í™”
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <select id="monthFilter" onchange="updateDashboard()">
Â  Â  Â  Â  Â  Â  <option value="all">ğŸ“… ì „ì²´ ê¸°ê°„ ë³´ê¸°</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  <button class="btn-style compare-btn" onclick="openCompareModal()">
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-scale-balanced"></i> ì„±ê³¼ ë¹„êµ
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button class="btn-style report-btn" onclick="generateReport()">
Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-file-pen"></i> ë³´ê³ ì„œ ìƒì„±
Â  Â  Â  Â  </button>
Â  Â  </div>
Â  Â  <input type="file" id="fileInput" accept=".csv, .xlsx, .xls" style="display: none;" multiple onchange="handleFiles(this)">

Â  Â  <div id="dashboard" style="display: none;">
Â  Â  Â  Â  <div id="insightSection" style="display: none;">
Â  Â  Â  Â  Â  Â  <div class="section-title">âœ¨ ì›”ê°„ ì„±ê³¼ ì¸ì‚¬ì´íŠ¸ (MoM)</div>
Â  Â  Â  Â  Â  Â  <div class="insight-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-label">í‰ê·  ê°ë‹¨ê°€(ARPU)</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-value" id="insightArpu">0ì›</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-desc">í•™ìƒ 1ì¸ë‹¹ ê²°ì œì•¡</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-label">ì¬ë“±ë¡ë¥ </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-value" id="insightRetention">0%</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-desc">ê¸°ì¡´ í•™ìƒ ìœ ì§€ í˜„í™©</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-card" style="cursor:pointer;" onclick="showInsightList('ì‹ ê·œ ìœ ì… í•™ìƒ', 'new')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-label">ì‹ ê·œ ìœ ì…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-value" id="insightNew">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-desc">ì´ë²ˆ ë‹¬ ì²« ë“±ë¡</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-card danger" style="cursor:pointer;" onclick="showInsightList('ì¬ë“±ë¡ í•„ìš” ëŒ€ìƒ(ì´íƒˆ ìœ„í—˜)', 'churn')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-label" style="color:#ff6b6b">ì´íƒˆ ìœ„í—˜(ë¯¸ë“±ë¡)</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="insight-value" id="insightChurn" style="color:#ff6b6b">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="badge-re">ì¬ë“±ë¡ í•„ìš” ëŒ€ìƒ</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="trendSection">
Â  Â  Â  Â  Â  Â  <div class="section-title">ğŸ“ˆ ì›”ë³„ ë§¤ì¶œ ì¶”ì´</div>
Â  Â  Â  Â  Â  Â  <div class="trend-card">
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:300px;"><canvas id="chartTrend"></canvas></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title"><span id="kpiTitle">ğŸ’° ì „ì²´ ë§¤ì¶œ í˜„í™©</span></div>
Â  Â  Â  Â  <div class="kpi-wrapper">
Â  Â  Â  Â  Â  Â  <div class="kpi-card total" onclick="showList('ìœ íš¨ ë§¤ì¶œ ì „ì²´', 'valid_sales')">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="icon-circle" style="background:#f0f4ff; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 10px; color:#8cb6ff;"><i class="fa-solid fa-coins"></i></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="kpi-label">ì´ ìœ íš¨ ë§¤ì¶œì•¡</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="kpi-amount" id="kpiTotalAmt">0ì›</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="kpi-count" id="kpiTotalCnt" style="color:#666; margin-top:5px;">0ê±´</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; color:#999; margin-top:5px;">(ê°•ì¢Œ + PTê¶Œ í•©ê³„)</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="kpi-card cancel" onclick="showList('ì „ì²´ í™˜ë¶ˆ (0ì›)', 'full_cancel')">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="icon-circle" style="background:#fff0f0; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 10px; color:#ff9aa2;"><i class="fa-solid fa-ban"></i></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="kpi-label">ì „ì²´ í™˜ë¶ˆ (ë§¤ì¶œ ì·¨ì†Œ)</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="kpi-amount" id="kpiCancelCnt" style="font-size:1.8rem;">0ê±´</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:12px; color:#ff6f91; margin-top:5px;">* ìˆ˜ê°• ì‹œì‘ ì „ ì·¨ì†Œ ê±´ìˆ˜</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="keyboardSection" style="display:none;">
Â  Â  Â  Â  Â  Â  <div class="section-title">âŒ¨ï¸ í‚¤ë³´ë“œ êµ¬ë§¤ì ì‹¬ì¸µ ë¶„ì„</div>
Â  Â  Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="conversion-card" style="grid-column: span 2;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conversion-stats">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ì´ í‚¤ë³´ë“œ êµ¬ë§¤ì</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val" id="kbTotal">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ìˆ˜ê°•ìƒ ì „í™˜ ì„±ê³µ</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val" id="kbSuccess" style="color:#ff6f91;">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ì „í™˜ìœ¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val conv-rate" id="kbRate" style="color:#ff6f91;">0%</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">í‰ê·  ìˆ˜ê°• ë“±ë¡ ì†Œìš”ì‹œê°„</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val" id="kbAvgDays" style="color:#666; font-size:1.4rem;">0ì¼</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="font-size:0.8rem; color:#aaa;">(êµ¬ë§¤ í›„ ì²« ê²°ì œê¹Œì§€)</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; flex-wrap:wrap; gap:20px; justify-content:center; margin-top:20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex:1; min-width:300px; text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#666;">â³ êµ¬ë§¤ í›„ ìˆ˜ê°• ì‹ ì²­ê¹Œì§€ ê±¸ë¦° ì‹œê°„</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div style="height:250px;"><canvas id="chartKbTime"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex:1; min-width:300px; text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#666;">ğŸ“ ì²« ìˆ˜ê°• ì‹ ì²­ ê³¼ëª© ì„ í˜¸ë„</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div style="height:250px;"><canvas id="chartKbClass"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:30px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#666;">ğŸ‚ ì—°ë ¹ëŒ€ë³„ ìˆ˜ê°• ì „í™˜ ë¶„í¬</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartKbAge"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="text-align:center; color:#999; font-size:0.8rem; margin-top:5px;">* ì—‘ì…€ì— ìƒë…„ ì •ë³´(ì˜ˆ: 1990, 90 ë“±)ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ í‘œì‹œë©ë‹ˆë‹¤.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:30px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ğŸ‰ í‚¤ë³´ë“œ êµ¬ë§¤ -> ìˆ˜ê°•ìƒ ì „í™˜ ëª…ë‹¨</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="overflow-y: auto; max-height: 300px; border:1px solid #eee; border-radius:10px; padding:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableKbConversion">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th>ì´ë¦„</th><th>êµ¬ë§¤ì¼</th><th>ì²« ìˆ˜ê°•ì¼</th><th>ì†Œìš”ê¸°ê°„</th><th>ì²« ê³¼ëª©</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ†“ ë¬´ë£Œ ì²´í—˜ ì „í™˜ìœ¨ ë¶„ì„</div>
Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  <div class="conversion-card" style="grid-column: span 2;">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ë¬´ë£Œ ì‚¬ìš©ì ìœ ë£Œ ê²°ì œ ì „í™˜ ë¶„ì„</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="conversion-stats">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ì´ ë¬´ë£Œì²´í—˜</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val" id="convTotal">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ìœ ë£Œ ì „í™˜ ì„±ê³µ</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val" id="convSuccess" style="color:#10b981;">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-stat-box">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-label">ì „í™˜ìœ¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="conv-val conv-rate" id="convRate">0%</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; flex-wrap:wrap; gap:20px; justify-content:center; margin-top:20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex:1; min-width:300px; text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#666; margin-bottom:10px;">ğŸ“Š ì „í™˜ vs ë¯¸ì „í™˜</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartConversion"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="flex:1; min-width:300px; text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="color:#666; margin-bottom:10px;">ğŸ° ì „í™˜ ìƒí’ˆ ìƒì„¸ ë¹„ìœ¨</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartConversionDetail"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:30px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ğŸ‰ ìœ ë£Œ ì „í™˜ ì„±ê³µ ëª…ë‹¨</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="overflow-y: auto; max-height: 300px; border:1px solid #eee; border-radius:10px; padding:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableConversion">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th>ì´ë¦„</th><th>ì „í™”ë²ˆí˜¸</th><th>ì „í™˜ëœ ìƒí’ˆ(ëŒ€í‘œ)</th><th>í™•ì¸</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ”¥ ìˆ˜ì—… í˜¼ì¡ë„ íˆíŠ¸ë§µ (í™”ìƒìˆ˜ì—…/CLASS)</div>
Â  Â  Â  Â  <div class="heatmap-container">
Â  Â  Â  Â  Â  Â  <div id="heatmapArea"></div>
Â  Â  Â  Â  Â  Â  <p style="color:#999; font-size:0.85rem; margin-top:10px; text-align:right;">* PTê¶Œ ë° ìš”ì¼/ì‹œê°„ ì •ë³´ê°€ ì—†ëŠ” ê±´ì€ ì œì™¸ë©ë‹ˆë‹¤.</p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ“¦ ìƒí’ˆë³„ ìƒì„¸ ë¶„ì„</div>
Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ìœ í˜•ë³„ ë§¤ì¶œ (PT í¬í•¨)</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartType"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableType"><thead><tr><th>êµ¬ë¶„</th><th>ë§¤ì¶œ</th><th>ê±´ìˆ˜</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ğŸ“ ë°˜(Class)ë³„ ì„¸ë¶„í™” ë¶„í¬</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartClass"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableClass"><thead><tr><th>ë°˜ì´ë¦„</th><th>ë§¤ì¶œ</th><th>ê±´ìˆ˜</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ“† ì˜µì…˜(ìš”ì¼/ì‹œê°„) í†µê³„</div>
Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ìš”ì¼ë³„ ìˆ˜ê°•ìƒ(í™”ìƒìˆ˜ì—…+ì‹œëŒ€ë°˜)</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartDay"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableDay"><thead><tr><th>ìš”ì¼</th><th>ì¸ì›ìˆ˜</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">â° ì‹œê°„ëŒ€ë³„ ìˆ˜ê°•ìƒ (ì˜¤ë¦„ì°¨ìˆœ)</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartTime"></canvas></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableTime"><thead><tr><th>ì‹œê°„</th><th>ì¸ì›ìˆ˜</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ† VIP & ì¬ë“±ë¡ ë¶„ì„</div>
Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ğŸ’ ê²°ì œ ê¸ˆì•¡ TOP 10</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableVip"><thead><tr><th>ìˆœìœ„</th><th>ì´ë¦„</th><th>ì´ ê²°ì œì•¡</th><th>ê±´ìˆ˜</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="margin-top:0; color:#444;">ğŸ† VIP ì¬ê²°ì œ íšŸìˆ˜ TOP 10</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="tableRevisit"><thead><tr><th>ì´ë¦„</th><th>ì—°ë½ì²˜</th><th>ê²°ì œíšŸìˆ˜</th><th>ì´ì•¡</th><th>í™•ì¸</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="section-title">ğŸ’ ìˆ˜ê°•ìƒ ìƒì• ì£¼ê¸°(LTV) ë¶„ì„</div>
Â  Â  Â  Â  <div class="analysis-grid">
Â  Â  Â  Â  Â  Â  <div class="ltv-card">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>ì´ ìˆ˜ê°•ìƒ ìˆ˜ (Unique)</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ltv-stat" id="ltvTotalStudents">0ëª…</div>
Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:0.9rem;">í•™ì›ì„ ê±°ì³ê°„ ëª¨ë“  í•™ìƒ</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="ltv-card">
Â  Â  Â  Â  Â  Â  Â  Â  <h4>í‰ê·  ìˆ˜ê°• ê°œì›” ìˆ˜</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ltv-stat" id="ltvAvgDuration">0ê°œì›”</div>
Â  Â  Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:0.9rem;">í•œ í•™ìƒì´ ë¨¸ë¬´ëŠ” í‰ê·  ê¸°ê°„</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h4 style="margin-top:0;">ìˆ˜ê°• ê¸°ê°„ ë¶„í¬ (ì¶©ì„±ë„)</h4>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="height:200px;"><canvas id="chartLtv"></canvas></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>
</div>

<div class="modal-overlay" id="studentModal" onclick="if(event.target.id==='studentModal') this.style.display='none'">
Â  Â  <div class="modal-box">
Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  <div class="modal-title" id="modalTitle">í•™ìƒ ëª…ë‹¨</div>
Â  Â  Â  Â  Â  Â  <div style="display:flex; align-items:center;">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-style upload-btn" onclick="copyList()"><i class="fa-regular fa-copy"></i> ë³µì‚¬</button>
Â  Â  Â  Â  Â  Â  Â  Â  <span style="font-size:24px; cursor:pointer; margin-left:15px; color:#aaa;" onclick="document.getElementById('studentModal').style.display='none'">&times;</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="modalList" style="overflow-y:auto; flex:1;"></div>
Â  Â  </div>
</div>

<div class="modal-overlay" id="compareModal" onclick="if(event.target.id==='compareModal') this.style.display='none'">
Â  Â  <div class="modal-box" style="width:700px;">
Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  <div class="modal-title">ğŸ†š ì›”ë³„ ì„±ê³¼ ë¹„êµ</div>
Â  Â  Â  Â  Â  Â  <span style="font-size:24px; cursor:pointer; color:#aaa;" onclick="document.getElementById('compareModal').style.display='none'">&times;</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="display:flex; gap:10px; justify-content:center; margin-bottom:20px;">
Â  Â  Â  Â  Â  Â  <select id="compA"></select>Â 
Â  Â  Â  Â  Â  Â  <span style="font-size:1.5rem; color:#ccc;">VS</span>
Â  Â  Â  Â  Â  Â  <select id="compB"></select>
Â  Â  Â  Â  Â  Â  <button class="btn-style compare-btn" onclick="doCompare()">ë¹„êµ ì‹¤í–‰</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="compareResult" style="display:none; flex:1; overflow-y:auto;">
Â  Â  Â  Â  Â  Â  <div class="compare-grid-modal">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="compare-col">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="compLabelA" style="color:#888; font-weight:bold;">Aì›”</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="compare-val" id="compValA">0ì›</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="compare-col">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="compLabelB" style="color:#888; font-weight:bold;">Bì›”</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="compare-val" id="compValB">0ì›</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="text-align:center; margin:15px 0; font-size:1.1rem;">
Â  Â  Â  Â  Â  Â  Â  Â  ë§¤ì¶œ ì°¨ì´: <span id="compDiff">0ì›</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="height:250px;"><canvas id="chartCompare"></canvas></div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<div class="modal-overlay" id="reportModal" onclick="if(event.target.id==='reportModal') this.style.display='none'">
Â  Â  <div class="modal-box" style="width:600px;">
Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  <div class="modal-title">ğŸ“ ìë™ ìƒì„±ëœ ì„±ê³¼ ë³´ê³ ì„œ</div>
Â  Â  Â  Â  Â  Â  <span style="font-size:24px; cursor:pointer; color:#aaa;" onclick="document.getElementById('reportModal').style.display='none'">&times;</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <p style="color:#888; font-size:0.9rem; margin-top:0;">ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•´ì„œ ì¹´í†¡ì´ë‚˜ ë¬¸ì„œì— ë°”ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.</p>
Â  Â  Â  Â  <textarea id="reportText" class="report-textarea"></textarea>
Â  Â  Â  Â  <div style="text-align:center; margin-top:15px;">
Â  Â  Â  Â  Â  Â  Â <button class="btn-style upload-btn" onclick="copyReport()"><i class="fa-regular fa-copy"></i> ì „ì²´ ë³µì‚¬</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
Â  Â  // ì „ì—­ ë³€ìˆ˜
Â  Â  let db = [], filteredDb = [], monthList = new Set();
Â  Â  let freeUserDb = []; // ë¬´ë£Œ ì‚¬ìš©ì ëª…ë‹¨ ì €ì¥
Â  Â  let keyboardDb = []; // [ì‹ ê·œ] í‚¤ë³´ë“œ êµ¬ë§¤ì ëª…ë‹¨ ì €ì¥
Â  Â  let churnList = [], newList = [];
Â  Â  let currentKpi = { amt:0, cnt:0 };

Â  Â  // --- [íŒŒì¼ ì²˜ë¦¬ ë° íŒŒì‹±] ---
Â  Â Â 
Â  Â  function resetData() {
Â  Â  Â  Â  if(confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
Â  Â  Â  Â  Â  Â  db = [];
Â  Â  Â  Â  Â  Â  freeUserDb = [];Â 
Â  Â  Â  Â  Â  Â  keyboardDb = []; // ì´ˆê¸°í™”
Â  Â  Â  Â  Â  Â  monthList.clear();
Â  Â  Â  Â  Â  Â  document.getElementById('fileInput').value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('dashboard').style.display = 'none';
Â  Â  Â  Â  Â  Â  alert('ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”.');
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function handleFiles(input) {
Â  Â  Â  Â  const files = input.files;
Â  Â  Â  Â  if (!files || files.length === 0) return;

Â  Â  Â  Â  let loadedCount = 0;
Â  Â  Â  Â  Array.from(files).forEach(file => {
Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  reader.onload = function(e) {
Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const data = new Uint8Array(e.target.result);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const workbook = XLSX.read(data, { type: 'array' });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const sheet = workbook.Sheets[workbook.SheetNames[0]];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: '', raw: false });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  processData(rows); // íŒŒì¼ ì¢…ë¥˜ ìë™ ê°ì§€
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadedCount++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(loadedCount === files.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  finalizeDataProcessing();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) { alert("íŒŒì¼ ì½ê¸° ì˜¤ë¥˜ ("+file.name+"): " + err.message); }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  reader.readAsArrayBuffer(file);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function finalizeDataProcessing() {
Â  Â  Â  Â  populateFilter();
Â  Â  Â  Â  updateDashboard();
Â  Â  Â  Â  analyzeLTV();
Â  Â  Â  Â Â 
Â  Â  Â  Â  let msg = `ë°ì´í„° ë¡œë“œ ì™„ë£Œ!\n- ë§¤ì¶œ ë‚´ì—­: ${db.length}ê±´\n- ë¬´ë£Œì²´í—˜: ${freeUserDb.length}ëª…`;
Â  Â  Â  Â  if(keyboardDb.length > 0) msg += `\n- í‚¤ë³´ë“œ êµ¬ë§¤ì: ${keyboardDb.length}ëª…`;
Â  Â  Â  Â  alert(msg);
Â  Â  }

Â  Â  function processData(rows) {
Â  Â  Â  Â  if(!rows || rows.length < 2) return;

Â  Â  Â  Â  let isGeneralSales = false;
Â  Â  Â  Â  let isPTSales = false;
Â  Â  Â  Â  let isFreeUsers = false;
Â  Â  Â  Â  let isKeyboard = false; // [ì‹ ê·œ] í‚¤ë³´ë“œ íŒŒì¼ íŒë³„
Â  Â  Â  Â Â 
Â  Â  Â  Â  // íŒŒì¼ ì¢…ë¥˜ ìë™ ê°ì§€ ë¡œì§
Â  Â  Â  Â  for(let i = 0; i < Math.min(rows.length, 5); i++) {
Â  Â  Â  Â  Â  Â  let rowStr = rows[i].map(x => String(x || '')).join(' ');

Â  Â  Â  Â  Â  Â  if (rowStr.includes('ì‹ ì²­ì •ë³´') && rowStr.includes('ì„ íƒì •ë³´')) {
Â  Â  Â  Â  Â  Â  Â  Â  isGeneralSales = true; break;
Â  Â  Â  Â  Â  Â  } else if ((rowStr.includes('ì£¼ë¬¸ë²ˆí˜¸') || rowStr.includes('í•™ìƒëª…')) && !rowStr.includes('ìˆ˜ì—… ì—¬ë¶€') && !rowStr.includes('í‚¤ë³´ë“œ')) {
Â  Â  Â  Â  Â  Â  Â  Â  // PT íŒŒì¼ê³¼ í‚¤ë³´ë“œ íŒŒì¼ êµ¬ë¶„ì´ í•„ìš”í•  ìˆ˜ ìˆìŒ. í‚¤ë³´ë“œëŠ” 'ìˆ˜ê°•' ê´€ë ¨ ë‹¨ì–´ê°€ ë³´í†µ ì—†ìŒ.
Â  Â  Â  Â  Â  Â  Â  Â  // ì—¬ê¸°ì„œëŠ” PT íŒŒì¼ í˜•ì‹ì„ ëª…í™•íˆ ë”°ë¦„.
Â  Â  Â  Â  Â  Â  Â  Â  isPTSales = true; break;
Â  Â  Â  Â  Â  Â  } else if (rowStr.includes('ìˆ˜ì—… ì—¬ë¶€') || rowStr.includes('ì¿ í° ë§Œë£Œì¼')) {
Â  Â  Â  Â  Â  Â  Â  Â  isFreeUsers = true; break;
Â  Â  Â  Â  Â  Â  } else if (rowStr.includes('ì£¼ë¬¸ì¼') || rowStr.includes('êµ¬ë§¤ì¼') || rowStr.includes('ì†¡ì¥ë²ˆí˜¸')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â // í‚¤ë³´ë“œ íŒŒì¼ ê°ì§€ (ìƒí’ˆëª… ë“±ì˜ ì»¬ëŸ¼ì´ ìˆì„ ê²ƒìœ¼ë¡œ ì¶”ì •)
Â  Â  Â  Â  Â  Â  Â  Â  Â isKeyboard = true; break;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  if (isGeneralSales) {
Â  Â  Â  Â  Â  Â  parseGeneralSales(rows);
Â  Â  Â  Â  } else if (isPTSales) {
Â  Â  Â  Â  Â  Â  parsePTSales(rows);
Â  Â  Â  Â  } else if (isFreeUsers) {
Â  Â  Â  Â  Â  Â  parseFreeUsers(rows);
Â  Â  Â  Â  } else if (isKeyboard) {
Â  Â  Â  Â  Â  Â  parseKeyboardUsers(rows); // [ì‹ ê·œ]
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // [ì‹ ê·œ] D. í‚¤ë³´ë“œ êµ¬ë§¤ì íŒŒì‹± í•¨ìˆ˜
Â  Â  function parseKeyboardUsers(rows) {
Â  Â  Â  Â  // í—¤ë” ì¸ë±ìŠ¤ ì°¾ê¸°
Â  Â  Â  Â  let headerIdx = rows.findIndex(r => r.some(c => String(c).includes('ì´ë¦„') || String(c).includes('êµ¬ë§¤ì')));
Â  Â  Â  Â  if(headerIdx === -1) return;

Â  Â  Â  Â  const headers = rows[headerIdx].map(x => String(x).trim());
Â  Â  Â  Â  const colIdx = {
Â  Â  Â  Â  Â  Â  name: headers.findIndex(h => h.includes('ì´ë¦„') || h.includes('êµ¬ë§¤ì') || h.includes('ì£¼ë¬¸ì')),
Â  Â  Â  Â  Â  Â  phone: headers.findIndex(h => h.includes('ì—°ë½ì²˜') || h.includes('ì „í™”') || h.includes('í•¸ë“œí°')),
Â  Â  Â  Â  Â  Â  date: headers.findIndex(h => h.includes('ì£¼ë¬¸ì¼') || h.includes('êµ¬ë§¤ì¼')),
Â  Â  Â  Â  Â  Â  birth: headers.findIndex(h => h.includes('ìƒë…„') || h.includes('ì£¼ë¯¼') || h.includes('ìƒì¼')) // ìˆ˜ì •ë¨
Â  Â  Â  Â  };

Â  Â  Â  Â  if(colIdx.name === -1 || colIdx.phone === -1) return;

Â  Â  Â  Â  for(let i = headerIdx + 1; i < rows.length; i++) {
Â  Â  Â  Â  Â  Â  let row = rows[i];
Â  Â  Â  Â  Â  Â  if(!row || !row[colIdx.name]) continue;

Â  Â  Â  Â  Â  Â  let name = String(row[colIdx.name]).trim();
Â  Â  Â  Â  Â  Â  let phone = cleanPhone(String(row[colIdx.phone]));
Â  Â  Â  Â  Â  Â  let dateObj = parseDate(row[colIdx.date]);
Â  Â  Â  Â  Â  Â  let birth = (colIdx.birth !== -1) ? String(row[colIdx.birth]).trim() : '';

Â  Â  Â  Â  Â  Â  if(name && phone && dateObj) {
Â  Â  Â  Â  Â  Â  Â  Â  keyboardDb.push({Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: name,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  phone: phone,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: dateObj, // Date ê°ì²´ë¡œ ì €ì¥
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  birth: birthÂ 
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // C. ë¬´ë£Œ ì‚¬ìš©ì íŒŒì‹±
Â  Â  function parseFreeUsers(rows) {
Â  Â  Â  Â  let headerIdx = rows.findIndex(r => r.some(c => String(c).includes('ì„±ëª…') || String(c).includes('ì´ë¦„')));
Â  Â  Â  Â  if(headerIdx === -1) return;

Â  Â  Â  Â  const headers = rows[headerIdx].map(x => String(x).trim());
Â  Â  Â  Â  const colIdx = {
Â  Â  Â  Â  Â  Â  name: headers.findIndex(h => h === 'ì„±ëª…' || h === 'ì´ë¦„'),
Â  Â  Â  Â  Â  Â  phone: headers.findIndex(h => h === 'í•¸ë“œí°' || h === 'ì—°ë½ì²˜' || h === 'ì „í™”ë²ˆí˜¸')
Â  Â  Â  Â  };

Â  Â  Â  Â  if(colIdx.name === -1 || colIdx.phone === -1) return;

Â  Â  Â  Â  for(let i = headerIdx + 1; i < rows.length; i++) {
Â  Â  Â  Â  Â  Â  let row = rows[i];
Â  Â  Â  Â  Â  Â  if(!row || !row[colIdx.name]) continue;
Â  Â  Â  Â  Â  Â  let name = String(row[colIdx.name]).trim();
Â  Â  Â  Â  Â  Â  let phone = String(row[colIdx.phone]).trim();
Â  Â  Â  Â  Â  Â  if(name && phone) {
Â  Â  Â  Â  Â  Â  Â  Â  freeUserDb.push({ name: name, phone: cleanPhone(phone) });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // A. ì¼ë°˜ ë§¤ì¶œ íŒŒì‹±
Â  Â  function parseGeneralSales(rows) {
Â  Â  Â  Â  let statusIdx = findStatusCol(rows);
Â  Â  Â  Â  if(statusIdx === -1) return;

Â  Â  Â  Â  let i = 0;
Â  Â  Â  Â  while(i < rows.length) {
Â  Â  Â  Â  Â  Â  let row = rows[i];
Â  Â  Â  Â  Â  Â  if (!row || row.length < statusIdx) { i++; continue; }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let status = String(row[statusIdx]).trim();
Â  Â  Â  Â  Â  Â  if(status === 'ê²°ì œì™„ë£Œ' || status.includes('ì·¨ì†Œ')) {
Â  Â  Â  Â  Â  Â  Â  Â  let priceRaw = row[statusIdx-1] || row[4];Â 
Â  Â  Â  Â  Â  Â  Â  Â  let price = parseInt(String(priceRaw).replace(/[^\d]/g, '')) || 0;
Â  Â  Â  Â  Â  Â  Â  Â  let dateObj = parseDate(row[0]);
Â  Â  Â  Â  Â  Â  Â  Â  let dateStr = getDateStr(dateObj);Â 
Â  Â  Â  Â  Â  Â  Â  Â  let monthKey = getMonthKey(dateObj);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (!monthKey) { i++; continue; }

Â  Â  Â  Â  Â  Â  Â  Â  let item = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: dateStr, dateObj: dateObj, month: monthKey, name: row[3], phone: '',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  product: '', price: price, status: status, option: '',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  type: '', classInfo: '', dayInfo: '', timeInfo: '',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isPartial: false, isFullCancel: false
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  if(i+1 < rows.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let rowB = rows[i+1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item.product = String(rowB[1]);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item.phone = cleanPhone(String(rowB[3])); // ì „í™”ë²ˆí˜¸ ì •ì œ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let increment = 2;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(i+2 < rows.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let optInfo = String(rows[i+2][1]);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(optInfo.includes('ì˜µì…˜')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item.option = optInfo;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  increment = 3;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  processItemType(item);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  db.push(item);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (monthKey) monthList.add(monthKey);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  i += increment;
Â  Â  Â  Â  Â  Â  Â  Â  } else { i++; }
Â  Â  Â  Â  Â  Â  } else { i++; }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // B. PT ë§¤ì¶œ íŒŒì‹±
Â  Â  function parsePTSales(rows) {
Â  Â  Â  Â  let headerIdx = rows.findIndex(r => r.some(c => String(c).includes('ì£¼ë¬¸ë²ˆí˜¸') || String(c).includes('í•™ìƒëª…')));
Â  Â  Â  Â  if(headerIdx === -1) return;

Â  Â  Â  Â  const headers = rows[headerIdx].map(x => String(x).trim());
Â  Â  Â  Â  const colIdx = {
Â  Â  Â  Â  Â  Â  date: headers.findIndex(h => h.includes('ì‹ ì²­ì¼') || h.includes('ê²°ì œì¼')),
Â  Â  Â  Â  Â  Â  name: headers.findIndex(h => h === 'í•™ìƒëª…'),
Â  Â  Â  Â  Â  Â  phone: headers.findIndex(h => h === 'ì—°ë½ì²˜'),
Â  Â  Â  Â  Â  Â  product: headers.findIndex(h => h === 'ìƒí’ˆëª…'),
Â  Â  Â  Â  Â  Â  price: headers.findIndex(h => h === 'ê²°ì œê¸ˆì•¡'),
Â  Â  Â  Â  Â  Â  status: headers.findIndex(h => h === 'ê²°ì œìƒíƒœ')
Â  Â  Â  Â  };

Â  Â  Â  Â  for(let i = headerIdx + 1; i < rows.length; i++) {
Â  Â  Â  Â  Â  Â  let row = rows[i];
Â  Â  Â  Â  Â  Â  if(!row || !row[colIdx.price]) continue;

Â  Â  Â  Â  Â  Â  let status = String(row[colIdx.status]).trim();
Â  Â  Â  Â  Â  Â  if (status !== 'ê²°ì œì™„ë£Œ' && !status.includes('ì·¨ì†Œ')) continue;

Â  Â  Â  Â  Â  Â  let price = parseInt(String(row[colIdx.price]).replace(/[^\d]/g, '')) || 0;
Â  Â  Â  Â  Â  Â  let dateObj = parseDate(row[colIdx.date]);
Â  Â  Â  Â  Â  Â  let dateStr = getDateStr(dateObj);
Â  Â  Â  Â  Â  Â  let monthKey = getMonthKey(dateObj);

Â  Â  Â  Â  Â  Â  if(!monthKey) continue;

Â  Â  Â  Â  Â  Â  let item = {
Â  Â  Â  Â  Â  Â  Â  Â  date: dateStr, dateObj: dateObj, month: monthKey,Â 
Â  Â  Â  Â  Â  Â  Â  Â  name: String(row[colIdx.name]).trim(),Â 
Â  Â  Â  Â  Â  Â  Â  Â  phone: cleanPhone(String(row[colIdx.phone])),
Â  Â  Â  Â  Â  Â  Â  Â  product: String(row[colIdx.product]).trim(),Â 
Â  Â  Â  Â  Â  Â  Â  Â  price: price, status: status, option: '',
Â  Â  Â  Â  Â  Â  Â  Â  type: 'PT ì´ìš©ê¶Œ', classInfo: '', dayInfo: '', timeInfo: '',
Â  Â  Â  Â  Â  Â  Â  Â  isPartial: false, isFullCancel: false
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if(item.product.includes('íšŒê¶Œ')) item.type = 'PT ì´ìš©ê¶Œ';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if(status.includes('ì·¨ì†Œ')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â if (price >= 10000) item.isPartial = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â else item.isFullCancel = true;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  db.push(item);
Â  Â  Â  Â  Â  Â  monthList.add(monthKey);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function processItemType(item) {
Â  Â  Â  Â  let isValid = false;
Â  Â  Â  Â  if (item.status === 'ê²°ì œì™„ë£Œ') isValid = true;
Â  Â  Â  Â  else if (item.status.includes('ì·¨ì†Œ') && item.price >= 10000) {
Â  Â  Â  Â  Â  Â  isValid = true;
Â  Â  Â  Â  Â  Â  item.isPartial = true;
Â  Â  Â  Â  } else if (item.status.includes('ì·¨ì†Œ')) {
Â  Â  Â  Â  Â  Â  item.isFullCancel = true;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (isValid || item.isFullCancel) {
Â  Â  Â  Â  Â  Â  if (item.type === 'PT ì´ìš©ê¶Œ') return;

Â  Â  Â  Â  Â  Â  if (item.product.includes('ì˜¬íŒ¨ìŠ¤')) item.type = 'ì˜¬íŒ¨ìŠ¤';
Â  Â  Â  Â  Â  Â  else if (item.product.includes('ì‹œí—˜ëŒ€ë¹„') && item.product.includes('ìë£Œ')) item.type = 'ì‹œí—˜ëŒ€ë¹„ë°˜ ìë£Œì´ìš©';
Â  Â  Â  Â  Â  Â  else if (item.product.includes('ì‹œí—˜ëŒ€ë¹„')) item.type = 'ì‹œí—˜ëŒ€ë¹„ CLASS';
Â  Â  Â  Â  Â  Â  else item.type = 'í™”ìƒìˆ˜ì—…';

Â  Â  Â  Â  Â  Â  if (item.product.includes('ì‹œí—˜ëŒ€ë¹„') && !item.product.includes('ìë£Œ')) item.classInfo = 'ì‹œí—˜ëŒ€ë¹„ CLASS';
Â  Â  Â  Â  Â  Â  else if (item.product.includes('ì…ë¬¸')) item.classInfo = 'ì…ë¬¸/ì¤‘ê¸‰ CLASS';
Â  Â  Â  Â  Â  Â  else if (item.product.includes('ê³ ê¸‰')) item.classInfo = 'ê³ ê¸‰ CLASS';
Â  Â  Â  Â  Â  Â  else if (item.product.includes('ì‹¬ì•¼')) item.classInfo = 'ì‹¬ì•¼ CLASS';
Â  Â  Â  Â  Â  Â  else item.classInfo = '';

Â  Â  Â  Â  Â  Â  let dM = item.option.match(/\[ìš”ì¼\]\s*([^,]+)/);
Â  Â  Â  Â  Â  Â  if(dM) item.dayInfo = dM[1].trim();
Â  Â  Â  Â  Â  Â  let tM = item.option.match(/\[ì‹œê°„\]\s*([^,]+)/);
Â  Â  Â  Â  Â  Â  if(tM) {
Â  Â  Â  Â  Â  Â  Â  Â  let tStr = tM[1].trim().replace(/[:ì‹œë¶„]/g, '').substring(0,2);
Â  Â  Â  Â  Â  Â  Â  Â  if(!isNaN(parseInt(tStr))) item.timeInfo = parseInt(tStr);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function findStatusCol(rows) {
Â  Â  Â  Â  for(let r=0; r<Math.min(rows.length, 50); r++) {
Â  Â  Â  Â  Â  Â  for(let c=0; c<rows[r].length; c++) {
Â  Â  Â  Â  Â  Â  Â  Â  if(String(rows[r][c]).includes('ê²°ì œìƒíƒœ')) return c;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  return 5;
Â  Â  }

Â  Â  function parseDate(raw) {
Â  Â  Â  Â  if (!raw) return null;
Â  Â  Â  Â  let str = String(raw).trim();
Â  Â  Â  Â  if (!isNaN(str) && str.length < 6 && str.length > 4) {
Â  Â  Â  Â  Â  Â  let date = new Date((Number(str) - (25567 + 2)) * 86400 * 1000);
Â  Â  Â  Â  Â  Â  return date;
Â  Â  Â  Â  }
Â  Â  Â  Â  let cleanStr = str.replace(/[./]/g, '-').split(' ')[0];
Â  Â  Â  Â  let date = new Date(cleanStr);
Â  Â  Â  Â  if (!isNaN(date.getTime())) return date;
Â  Â  Â  Â  return null;
Â  Â  }

Â  Â  function getMonthKey(dateObj) {
Â  Â  Â  Â  if (!dateObj) return "";
Â  Â  Â  Â  let y = dateObj.getFullYear();
Â  Â  Â  Â  let m = String(dateObj.getMonth() + 1).padStart(2, '0');
Â  Â  Â  Â  if(isNaN(y) || isNaN(m)) return "";
Â  Â  Â  Â  return `${y}-${m}`;
Â  Â  }

Â  Â  function getDateStr(dateObj) {
Â  Â  Â  Â  if (!dateObj) return "";
Â  Â  Â  Â  let y = dateObj.getFullYear();
Â  Â  Â  Â  let m = String(dateObj.getMonth() + 1).padStart(2, '0');
Â  Â  Â  Â  let d = String(dateObj.getDate()).padStart(2, '0');
Â  Â  Â  Â  return `${y}-${m}-${d}`;
Â  Â  }
Â  Â Â 
Â  Â  function cleanPhone(str) {
Â  Â  Â  Â  if(!str) return "";
Â  Â  Â  Â  return str.replace(/[^\d]/g, '');
Â  Â  }

Â  Â  function populateFilter() {
Â  Â  Â  Â  const sel = document.getElementById('monthFilter');
Â  Â  Â  Â  sel.innerHTML = '<option value="all">ğŸ“… ì „ì²´ ê¸°ê°„ ë³´ê¸°</option>';
Â  Â  Â  Â  let list = Array.from(monthList).sort().reverse();
Â  Â  Â  Â  list.forEach(m => { if(m) sel.innerHTML += `<option value="${m}">${m}ì›” ë§¤ì¶œ</option>`; });
Â  Â  }

Â  Â  // --- [ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ & ë¶„ì„ ë¡œì§] ---

Â  Â  function updateDashboard() {
Â  Â  Â  Â  const mon = document.getElementById('monthFilter').value;
Â  Â  Â  Â  document.getElementById('dashboard').style.display = 'block';
Â  Â  Â  Â  document.getElementById('trendSection').style.display = (mon === 'all') ? 'block' : 'none';
Â  Â  Â  Â  document.getElementById('insightSection').style.display = (mon === 'all') ? 'none' : 'block';

Â  Â  Â  Â  if(mon === 'all') {
Â  Â  Â  Â  Â  Â  filteredDb = db;
Â  Â  Â  Â  Â  Â  document.getElementById('kpiTitle').innerText = 'ğŸ’° ì „ì²´ ëˆ„ì  ë§¤ì¶œ í˜„í™©';
Â  Â  Â  Â  Â  Â  renderTrend();Â 
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  filteredDb = db.filter(i => i.month === mon);
Â  Â  Â  Â  Â  Â  document.getElementById('kpiTitle').innerText = `ğŸ’° ${mon}ì›” ë§¤ì¶œ í˜„í™©`;
Â  Â  Â  Â  }
Â  Â  Â  Â  analyze(filteredDb, mon);
Â  Â  Â  Â  calculateGoal();
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(freeUserDb.length > 0) analyzeConversion();
Â  Â  Â  Â  if(keyboardDb.length > 0) {
Â  Â  Â  Â  Â  Â  document.getElementById('keyboardSection').style.display = 'block';
Â  Â  Â  Â  Â  Â  analyzeKeyboardConversion(); // [ì‹ ê·œ] í‚¤ë³´ë“œ ë¶„ì„ ì‹¤í–‰
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â document.getElementById('keyboardSection').style.display = 'none';
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // [ì‹ ê·œ] í‚¤ë³´ë“œ êµ¬ë§¤ì ë¶„ì„ ë¡œì§
Â  Â  function analyzeKeyboardConversion() {
Â  Â  Â  Â  let totalKb = keyboardDb.length;
Â  Â  Â  Â  let converted = [];
Â  Â  Â  Â  let timeToConvert = []; // ì†Œìš” ì‹œê°„ (ì¼)
Â  Â  Â  Â  let firstClassStats = {}; // ì²« ìˆ˜ê°• ê³¼ëª©
Â  Â  Â  Â  let ageStats = {}; // ì—°ë ¹ëŒ€
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ê²°ì œ ë‚´ì—­ì„ ì „í™”ë²ˆí˜¸ë¡œ ê·¸ë£¹í™” (ë¹ ë¥¸ ê²€ìƒ‰ì„ ìœ„í•´)
Â  Â  Â  Â  let payMap = {};
Â  Â  Â  Â  db.forEach(item => {
Â  Â  Â  Â  Â  Â  if(!item.isFullCancel && item.phone) {
Â  Â  Â  Â  Â  Â  Â  Â  if(!payMap[item.phone]) payMap[item.phone] = [];
Â  Â  Â  Â  Â  Â  Â  Â  payMap[item.phone].push(item);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ì •ë ¬: ê²°ì œ ë‚´ì—­ì„ ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬
Â  Â  Â  Â  Object.keys(payMap).forEach(key => {
Â  Â  Â  Â  Â  Â  payMap[key].sort((a,b) => a.dateObj - b.dateObj);
Â  Â  Â  Â  });

Â  Â  Â  Â  keyboardDb.forEach(kb => {
Â  Â  Â  Â  Â  Â  let userPays = payMap[kb.phone];
Â  Â  Â  Â  Â  Â  if(userPays && userPays.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  // êµ¬ë§¤ì¼ ì´í›„ ì²« ê²°ì œ ì°¾ê¸°
Â  Â  Â  Â  Â  Â  Â  Â  let firstPay = userPays.find(p => p.dateObj >= kb.date);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if(firstPay) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let diffTime = Math.abs(firstPay.dateObj - kb.date);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  converted.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: kb.name,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  buyDate: getDateStr(kb.date),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  firstClassDate: getDateStr(firstPay.dateObj),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  diffDays: diffDays,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  firstClass: firstPay.type + (firstPay.classInfo ? ` (${firstPay.classInfo})` : '')
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  timeToConvert.push(diffDays);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ì²« ìˆ˜ê°• ê³¼ëª© í†µê³„
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let cType = firstPay.type;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(cType.includes('PT')) cType = 'PT';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if(cType.includes('ì˜¬íŒ¨ìŠ¤')) cType = 'ì˜¬íŒ¨ìŠ¤';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if(cType.includes('ì‹œí—˜ëŒ€ë¹„')) cType = 'ì‹œí—˜ëŒ€ë¹„ë°˜';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else cType = 'ì •ê·œ í™”ìƒìˆ˜ì—…';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  firstClassStats[cType] = (firstClassStats[cType] || 0) + 1;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ì—°ë ¹ëŒ€ í†µê³„ (ìƒë…„ì›”ì¼ì´ ìˆëŠ” ê²½ìš°)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(kb.birth) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let bStr = String(kb.birth).trim().replace(/[^0-9]/g, ''); // ìˆ«ìë§Œ ì¶”ì¶œ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let fullYear = 0;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 1. 4ìë¦¬ (ì˜ˆ: 1995)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(bStr.length === 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fullYear = parseInt(bStr);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 2. 2ìë¦¬ or 6ìë¦¬ (ì˜ˆ: 95, 950101) -> ì• 2ìë¦¬ë¡œ íŒë‹¨
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if(bStr.length >= 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let yPrefix = parseInt(bStr.substring(0,2));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 30 ì´ìƒì´ë©´ 1900ë…„ëŒ€, ì•„ë‹ˆë©´ 2000ë…„ëŒ€ (í•™ì› íŠ¹ì„±ìƒ ìœ ì—°í•˜ê²Œ ì ìš©)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fullYear = (yPrefix > 30) ? 1900 + yPrefix : 2000 + yPrefix;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(fullYear > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let currentYear = new Date().getFullYear();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let age = currentYear - fullYear + 1; // í•œêµ­ë‚˜ì´ ê³„ì‚°
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let ageGroup = Math.floor(age / 10) * 10 + 'ëŒ€';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ageStats[ageGroup] = (ageStats[ageGroup] || 0) + 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ageStats['ë¯¸í™•ì¸'] = (ageStats['ë¯¸í™•ì¸'] || 0) + 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ageStats['ë¯¸í™•ì¸'] = (ageStats['ë¯¸í™•ì¸'] || 0) + 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // 1. KPI ì¹´ë“œ ì—…ë°ì´íŠ¸
Â  Â  Â  Â  document.getElementById('kbTotal').innerText = totalKb + "ëª…";
Â  Â  Â  Â  document.getElementById('kbSuccess').innerText = converted.length + "ëª…";
Â  Â  Â  Â  let rate = totalKb > 0 ? ((converted.length / totalKb) * 100).toFixed(1) : 0;
Â  Â  Â  Â  document.getElementById('kbRate').innerText = rate + "%";
Â  Â  Â  Â Â 
Â  Â  Â  Â  let avgDays = timeToConvert.length > 0 ? (timeToConvert.reduce((a,b)=>a+b,0) / timeToConvert.length).toFixed(0) : 0;
Â  Â  Â  Â  document.getElementById('kbAvgDays').innerText = avgDays + "ì¼";

Â  Â  Â  Â  // 2. ì°¨íŠ¸: ì†Œìš” ì‹œê°„ ë¶„í¬
Â  Â  Â  Â  let timeDist = {'1ì£¼ ì´ë‚´':0, '1ë‹¬ ì´ë‚´':0, '3ë‹¬ ì´ë‚´':0, '3ë‹¬ ì´í›„':0};
Â  Â  Â  Â  timeToConvert.forEach(d => {
Â  Â  Â  Â  Â  Â  if(d <= 7) timeDist['1ì£¼ ì´ë‚´']++;
Â  Â  Â  Â  Â  Â  else if(d <= 30) timeDist['1ë‹¬ ì´ë‚´']++;
Â  Â  Â  Â  Â  Â  else if(d <= 90) timeDist['3ë‹¬ ì´ë‚´']++;
Â  Â  Â  Â  Â  Â  else timeDist['3ë‹¬ ì´í›„']++;
Â  Â  Â  Â  });
Â  Â  Â  Â  renderChart('chartKbTime', fromObjToArr(timeDist), 'ì¸ì›', false, ['#ffb7b2', '#ffdac1', '#e2f0cb', '#b5ead7']);

Â  Â  Â  Â  // 3. ì°¨íŠ¸: ì²« ìˆ˜ê°• ê³¼ëª©
Â  Â  Â  Â  renderChart('chartKbClass', fromObjToArr(firstClassStats), 'ì¸ì›', false, ['#a2c2ff', '#95e1d3', '#ff9aa2', '#e0bbe4']);

Â  Â  Â  Â  // 4. ì°¨íŠ¸: ì—°ë ¹ëŒ€ (ë¯¸í™•ì¸ ì œì™¸í•˜ê³  í‘œì‹œí•˜ê±°ë‚˜ í¬í•¨í•˜ê±°ë‚˜ ê²°ì •)
Â  Â  Â  Â  // ë¯¸í™•ì¸ì´ ë„ˆë¬´ ë§ìœ¼ë©´ ì°¨íŠ¸ê°€ ì•ˆ ì˜ˆì˜ë‹ˆ, ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ë§Œ ê·¸ë¦¬ê¸°
Â  Â  Â  Â  let ageClean = {};
Â  Â  Â  Â  Object.keys(ageStats).forEach(k => { if(k !== 'ë¯¸í™•ì¸') ageClean[k] = ageStats[k]; });
Â  Â  Â  Â  if(Object.keys(ageClean).length > 0) {
Â  Â  Â  Â  Â  Â  Â renderChart('chartKbAge', fromObjToArr(ageClean), 'ì¸ì›', true, ['#ffd700', '#ffb7b2', '#a2c2ff', '#95e1d3']);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // ë°ì´í„° ì—†ìœ¼ë©´ ë¹ˆ ì°¨íŠ¸
Â  Â  Â  Â  Â  Â  Â renderChart('chartKbAge', [], 'ì¸ì›', false);
Â  Â  Â  Â  }

Â  Â  Â  Â  // 5. í…Œì´ë¸” ëª…ë‹¨
Â  Â  Â  Â  let tb = document.querySelector('#tableKbConversion tbody');
Â  Â  Â  Â  tb.innerHTML = '';
Â  Â  Â  Â  converted.forEach(u => {
Â  Â  Â  Â  Â  Â  let tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  tr.innerHTML = `<td>${u.name}</td><td>${u.buyDate}</td><td style="color:#ff6f91;font-weight:bold;">${u.firstClassDate}</td><td>${u.diffDays}ì¼</td><td>${u.firstClass}</td>`;
Â  Â  Â  Â  Â  Â  tb.appendChild(tr);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // ê°ì²´ë¥¼ ì°¨íŠ¸ìš© ë°°ì—´ë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼
Â  Â  function fromObjToArr(obj) {
Â  Â  Â  Â  let res = {amt:0, cnt:0, list:[]}; // ë”ë¯¸ êµ¬ì¡°
Â  Â  Â  Â  // renderChart í•¨ìˆ˜ê°€ ê¸°ì¡´ êµ¬ì¡°(obj[key].amt ë“±)ë¥¼ ì“°ë¯€ë¡œ ì´ì— ë§ì¶° ë³€í™˜í•˜ê±°ë‚˜
Â  Â  Â  Â  // renderChartë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ë˜í•‘í•¨
Â  Â  Â  Â  let wrapper = {};
Â  Â  Â  Â  Object.keys(obj).forEach(k => {
Â  Â  Â  Â  Â  Â  wrapper[k] = { cnt: obj[k], amt: 0, list: [] };
Â  Â  Â  Â  });
Â  Â  Â  Â  return wrapper;
Â  Â  }
Â  Â Â 
Â  Â  // ê¸°ì¡´ ë¶„ì„ í•¨ìˆ˜ë“¤ (ê·¸ëŒ€ë¡œ ìœ ì§€)
Â  Â  function analyzeConversion() {
Â  Â  Â  Â  if (freeUserDb.length === 0) return;

Â  Â  Â  Â  let convertedList = [];
Â  Â  Â  Â  let detailStats = {
Â  Â  Â  Â  Â  Â  'ì˜¬íŒ¨ìŠ¤': 0, 'ì‹œëŒ€ë°˜(ì‹œí—˜ëŒ€ë¹„)': 0, 'í¼ìŠ¤ë„í´ë˜ìŠ¤(PT)': 0,
Â  Â  Â  Â  Â  Â  'í™”ìƒìˆ˜ì—…(ì…ë¬¸/ì¤‘ê¸‰)': 0, 'í™”ìƒìˆ˜ì—…(ê³ ê¸‰)': 0, 'í™”ìƒìˆ˜ì—…(ì‹¬ì•¼)': 0, 'ê¸°íƒ€': 0
Â  Â  Â  Â  };

Â  Â  Â  Â  let payHistory = {};
Â  Â  Â  Â  db.forEach(item => {
Â  Â  Â  Â  Â  Â  if (!item.isFullCancel && item.phone) {
Â  Â  Â  Â  Â  Â  Â  Â  if (!payHistory[item.phone]) payHistory[item.phone] = [];
Â  Â  Â  Â  Â  Â  Â  Â  payHistory[item.phone].push(item);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  freeUserDb.forEach(freeUser => {
Â  Â  Â  Â  Â  Â  if (freeUser.phone && payHistory[freeUser.phone]) {
Â  Â  Â  Â  Â  Â  Â  Â  let userCategories = new Set();Â 
Â  Â  Â  Â  Â  Â  Â  Â  payHistory[freeUser.phone].forEach(payItem => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let cat = 'ê¸°íƒ€';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (payItem.type === 'ì˜¬íŒ¨ìŠ¤') cat = 'ì˜¬íŒ¨ìŠ¤';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (payItem.type === 'PT ì´ìš©ê¶Œ') cat = 'í¼ìŠ¤ë„í´ë˜ìŠ¤(PT)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (payItem.type.includes('ì‹œí—˜ëŒ€ë¹„')) cat = 'ì‹œëŒ€ë°˜(ì‹œí—˜ëŒ€ë¹„)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (payItem.type === 'í™”ìƒìˆ˜ì—…') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (payItem.classInfo.includes('ì…ë¬¸') || payItem.classInfo.includes('ì¤‘ê¸‰')) cat = 'í™”ìƒìˆ˜ì—…(ì…ë¬¸/ì¤‘ê¸‰)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (payItem.classInfo.includes('ê³ ê¸‰')) cat = 'í™”ìƒìˆ˜ì—…(ê³ ê¸‰)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else if (payItem.classInfo.includes('ì‹¬ì•¼')) cat = 'í™”ìƒìˆ˜ì—…(ì‹¬ì•¼)';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  userCategories.add(cat);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let repProduct = Array.from(userCategories)[0] || 'ê¸°íƒ€';
Â  Â  Â  Â  Â  Â  Â  Â  convertedList.push({ ...freeUser, repProduct: repProduct });

Â  Â  Â  Â  Â  Â  Â  Â  userCategories.forEach(c => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (detailStats[c] !== undefined) detailStats[c]++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else detailStats['ê¸°íƒ€']++;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  let totalFree = freeUserDb.length;
Â  Â  Â  Â  let convertedCount = convertedList.length;
Â  Â  Â  Â  let rate = totalFree > 0 ? ((convertedCount / totalFree) * 100).toFixed(1) : 0;

Â  Â  Â  Â  document.getElementById('convTotal').innerText = totalFree + 'ëª…';
Â  Â  Â  Â  document.getElementById('convSuccess').innerText = convertedCount + 'ëª…';
Â  Â  Â  Â  document.getElementById('convRate').innerText = rate + '%';

Â  Â  Â  Â  let ctx1 = document.getElementById('chartConversion').getContext('2d');
Â  Â  Â  Â  if (Chart.getChart('chartConversion')) Chart.getChart('chartConversion').destroy();
Â  Â  Â  Â  new Chart(ctx1, {
Â  Â  Â  Â  Â  Â  type: 'doughnut',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: ['ë¯¸ì „í™˜', 'ìœ ë£Œ ì „í™˜'],
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data: [totalFree - convertedCount, convertedCount],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: ['#f0f0f0', '#10b981'],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  borderWidth: 0
Â  Â  Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: { responsive: true, maintainAspectRatio: false, cutout: '60%' }
Â  Â  Â  Â  });

Â  Â  Â  Â  let ctx2 = document.getElementById('chartConversionDetail').getContext('2d');
Â  Â  Â  Â  if (Chart.getChart('chartConversionDetail')) Chart.getChart('chartConversionDetail').destroy();
Â  Â  Â  Â Â 
Â  Â  Â  Â  let detailLabels = [];
Â  Â  Â  Â  let detailData = [];
Â  Â  Â  Â  Object.keys(detailStats).forEach(k => {
Â  Â  Â  Â  Â  Â  if(detailStats[k] > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  detailLabels.push(k);
Â  Â  Â  Â  Â  Â  Â  Â  detailData.push(detailStats[k]);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  new Chart(ctx2, {
Â  Â  Â  Â  Â  Â  type: 'pie',Â 
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: detailLabels,
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data: detailData,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: ['#ffb7b2', '#ffd700', '#a2c2ff', '#95e1d3', '#e0bbe4', '#ffdac1', '#c7ceea'],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  borderWidth: 1
Â  Â  Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  responsive: true,Â 
Â  Â  Â  Â  Â  Â  Â  Â  maintainAspectRatio: false,
Â  Â  Â  Â  Â  Â  Â  Â  plugins: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  legend: { position: 'right', labels: { boxWidth: 12, font: { size: 11 } } }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  let tb = document.querySelector('#tableConversion tbody');
Â  Â  Â  Â  tb.innerHTML = '';
Â  Â  Â  Â  convertedList.forEach(u => {
Â  Â  Â  Â  Â  Â  let tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  let fmtPhone = u.phone.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
Â  Â  Â  Â  Â  Â  tr.innerHTML = `<td>${u.name}</td><td>${fmtPhone}</td><td>${u.repProduct}</td><td class="clickable-row">í™•ì¸</td>`;
Â  Â  Â  Â  Â  Â  tr.onclick = () => {
Â  Â  Â  Â  Â  Â  Â  Â  let userPayList = db.filter(p => p.phone === u.phone);
Â  Â  Â  Â  Â  Â  Â  Â  showList(`${u.name}ë‹˜ì˜ ì „í™˜ ë‚´ì—­`, 'list', userPayList);
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  tb.appendChild(tr);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function analyze(data, currentMon) {
Â  Â  Â  Â  let kpi = { amt:0, cnt:0, cancelCnt:0 };
Â  Â  Â  Â  let cats = { type:{}, class:{}, day:{}, time:{} };
Â  Â  Â  Â  let hm = { 'ì›”':{}, 'í™”':{}, 'ìˆ˜':{}, 'ëª©':{}, 'ê¸ˆ':{}, 'í† ':{}, 'ì¼':{} };
Â  Â  Â  Â  let stu = {};

Â  Â  Â  Â  data.forEach(i => {
Â  Â  Â  Â  Â  Â  if(i.isFullCancel) { kpi.cancelCnt++; return; }
Â  Â  Â  Â  Â  Â  kpi.amt += i.price;
Â  Â  Â  Â  Â  Â  kpi.cnt++;

Â  Â  Â  Â  Â  Â  addCnt(cats.type, i.type, i);

Â  Â  Â  Â  Â  Â  if(i.type !== 'ì˜¬íŒ¨ìŠ¤' && i.type !== 'PT ì´ìš©ê¶Œ') {
Â  Â  Â  Â  Â  Â  Â  Â  addCnt(cats.class, i.classInfo, i);
Â  Â  Â  Â  Â  Â  Â  Â  addCnt(cats.day, i.dayInfo, i);
Â  Â  Â  Â  Â  Â  Â  Â  if(i.timeInfo !== '') addCnt(cats.time, i.timeInfo + 'ì‹œ', i);
Â  Â  Â  Â  Â  Â  Â  Â  if(i.dayInfo && i.timeInfo !== '') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  i.dayInfo.split('').forEach(d => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(hm[d]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let t = i.timeInfo;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(!hm[d][t]) hm[d][t] = {cnt:0, list:[]};
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  hm[d][t].cnt++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  hm[d][t].list.push(i);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let key = i.phone || i.name;
Â  Â  Â  Â  Â  Â  if(!stu[key]) stu[key] = {name:i.name, phone:i.phone, amt:0, cnt:0, list:[]};
Â  Â  Â  Â  Â  Â  stu[key].amt += i.price;
Â  Â  Â  Â  Â  Â  stu[key].cnt++;
Â  Â  Â  Â  Â  Â  stu[key].list.push(i);
Â  Â  Â  Â  });

Â  Â  Â  Â  currentKpi = kpi;Â 

Â  Â  Â  Â  if (currentMon !== 'all') {
Â  Â  Â  Â  Â  Â  const uniqueStudents = Object.keys(stu);
Â  Â  Â  Â  Â  Â  const uniqueCount = uniqueStudents.length;

Â  Â  Â  Â  Â  Â  const arpu = uniqueCount > 0 ? Math.round(kpi.amt / uniqueCount) : 0;
Â  Â  Â  Â  Â  Â  document.getElementById('insightArpu').innerText = arpu.toLocaleString() + 'ì›';

Â  Â  Â  Â  Â  Â  let [y, m] = currentMon.split('-').map(Number);
Â  Â  Â  Â  Â  Â  let prevDate = new Date(y, m - 2, 1);
Â  Â  Â  Â  Â  Â  let prevMon = getMonthKey(prevDate);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let prevMonthStudents = new Set();
Â  Â  Â  Â  Â  Â  db.filter(i => i.month === prevMon && !i.isFullCancel)
Â  Â  Â  Â  Â  Â  Â  .forEach(i => prevMonthStudents.add(i.phone || i.name));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let reRegCount = 0;
Â  Â  Â  Â  Â  Â  uniqueStudents.forEach(k => { if(prevMonthStudents.has(k)) reRegCount++; });
Â  Â  Â  Â  Â  Â  const retentionRate = prevMonthStudents.size > 0 ? Math.round((reRegCount / prevMonthStudents.size) * 100) : 0;
Â  Â  Â  Â  Â  Â  document.getElementById('insightRetention').innerText = retentionRate + '%';

Â  Â  Â  Â  Â  Â  let totalPastStudents = new Set();
Â  Â  Â  Â  Â  Â  db.filter(i => i.month < currentMon && !i.isFullCancel)
Â  Â  Â  Â  Â  Â  Â  .forEach(i => totalPastStudents.add(i.phone || i.name));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  newList = uniqueStudents.filter(k => !totalPastStudents.has(k)).map(k => stu[k]);
Â  Â  Â  Â  Â  Â  document.getElementById('insightNew').innerText = newList.length + 'ëª…';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let churnKeys = Array.from(prevMonthStudents).filter(k => !stu[k]);
Â  Â  Â  Â  Â  Â  churnList = churnKeys.map(k => {
Â  Â  Â  Â  Â  Â  Â  Â  let lastInfo = db.filter(i => (i.phone || i.name) === k).pop();
Â  Â  Â  Â  Â  Â  Â  Â  return { name: lastInfo.name, phone: lastInfo.phone, product: 'ì „ì›” ìˆ˜ê°•ìƒ(ë¯¸ë“±ë¡)', price: 0, date: lastInfo.date };
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  document.getElementById('insightChurn').innerText = churnList.length + 'ëª…';
Â  Â  Â  Â  }

Â  Â  Â  Â  document.getElementById('kpiTotalAmt').innerText = kpi.amt.toLocaleString() + 'ì›';
Â  Â  Â  Â  document.getElementById('kpiTotalCnt').innerText = kpi.cnt + 'ê±´';
Â  Â  Â  Â  document.getElementById('kpiCancelCnt').innerText = kpi.cancelCnt + 'ê±´';
Â  Â  Â  Â Â 
Â  Â  Â  Â  const pastelColors = ['#a2c2ff', '#95e1d3', '#ffb7b2', '#e2f0cb', '#b5ead7', '#c7ceea', '#ffdac1', '#e0bbe4', '#f9f9f9'];
Â  Â  Â  Â  renderChart('chartType', cats.type, 'ë§¤ì¶œ', false, pastelColors);
Â  Â  Â  Â  renderChart('chartClass', cats.class, 'ë§¤ì¶œ', false, pastelColors);
Â  Â  Â  Â  renderChart('chartDay', cats.day, 'ì¸ì›', false, pastelColors);
Â  Â  Â  Â  renderChart('chartTime', cats.time, 'ì¸ì›', true, pastelColors);
Â  Â  Â  Â  renderTable('tableType', cats.type, 'ë§¤ì¶œ');
Â  Â  Â  Â  renderTable('tableClass', cats.class, 'ë§¤ì¶œ');
Â  Â  Â  Â  renderTable('tableDay', cats.day, 'ì¸ì›');
Â  Â  Â  Â  renderTable('tableTime', cats.time, 'ì¸ì›', true);Â 
Â  Â  Â  Â  renderHeatmap(hm);
Â  Â  Â  Â  renderVip(stu);
Â  Â  }

Â  Â  // --- [LTV ë¶„ì„ ê¸°ëŠ¥] ---
Â  Â  function analyzeLTV() {
Â  Â  Â  Â  if(db.length === 0) return;
Â  Â  Â  Â Â 
Â  Â  Â  Â  let stuMap = {};
Â  Â  Â  Â  db.forEach(i => {
Â  Â  Â  Â  Â  Â  if(i.isFullCancel) return;
Â  Â  Â  Â  Â  Â  let key = i.phone || i.name;
Â  Â  Â  Â  Â  Â  if(!stuMap[key]) stuMap[key] = { months: new Set() };
Â  Â  Â  Â  Â  Â  stuMap[key].months.add(i.month);
Â  Â  Â  Â  });

Â  Â  Â  Â  let counts = { '1ê°œì›”(ì‹ ê·œ/ë‹¨ë°œ)': 0, '2~3ê°œì›”(ìœ ì§€)': 0, '4~6ê°œì›”(ì¥ê¸°)': 0, '7ê°œì›” ì´ìƒ(VIP)': 0 };
Â  Â  Â  Â  let totalMonths = 0;
Â  Â  Â  Â  let totalStudents = 0;

Â  Â  Â  Â  Object.values(stuMap).forEach(s => {
Â  Â  Â  Â  Â  Â  let n = s.months.size;
Â  Â  Â  Â  Â  Â  totalMonths += n;
Â  Â  Â  Â  Â  Â  totalStudents++;
Â  Â  Â  Â  Â  Â  if(n === 1) counts['1ê°œì›”(ì‹ ê·œ/ë‹¨ë°œ)']++;
Â  Â  Â  Â  Â  Â  else if(n <= 3) counts['2~3ê°œì›”(ìœ ì§€)']++;
Â  Â  Â  Â  Â  Â  else if(n <= 6) counts['4~6ê°œì›”(ì¥ê¸°)']++;
Â  Â  Â  Â  Â  Â  else counts['7ê°œì›” ì´ìƒ(VIP)']++;
Â  Â  Â  Â  });

Â  Â  Â  Â  let avg = totalStudents > 0 ? (totalMonths / totalStudents).toFixed(1) : 0;
Â  Â  Â  Â  document.getElementById('ltvTotalStudents').innerText = totalStudents.toLocaleString() + 'ëª…';
Â  Â  Â  Â  document.getElementById('ltvAvgDuration').innerText = avg + 'ê°œì›”';

Â  Â  Â  Â  let ctx = document.getElementById('chartLtv').getContext('2d');
Â  Â  Â  Â  if(Chart.getChart('chartLtv')) Chart.getChart('chartLtv').destroy();
Â  Â  Â  Â  new Chart(ctx, {
Â  Â  Â  Â  Â  Â  type: 'pie',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: Object.keys(counts),
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data: Object.values(counts),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: ['#ffb7b2', '#ffd700', '#95e1d3', '#a2c2ff']
Â  Â  Â  Â  Â  Â  Â  Â  }]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: { responsive:true, maintainAspectRatio:false }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- [ëª©í‘œ ë§¤ì¶œ ê¸°ëŠ¥] ---
Â  Â  function inputNumberFormat(obj) {
Â  Â  Â  Â  obj.value = comma(uncomma(obj.value));
Â  Â  }
Â  Â  function comma(str) {
Â  Â  Â  Â  str = String(str);
Â  Â  Â  Â  return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g, '$1,');
Â  Â  }
Â  Â  function uncomma(str) {
Â  Â  Â  Â  str = String(str);
Â  Â  Â  Â  return str.replace(/[^\d]+/g, '');
Â  Â  }

Â  Â  function calculateGoal() {
Â  Â  Â  Â  const input = document.getElementById('targetInput').value;
Â  Â  Â  Â  const target = parseInt(uncomma(input));
Â  Â  Â  Â  const current = currentKpi.amt;
Â  Â  Â  Â  const bar = document.getElementById('goalProgressBar');
Â  Â  Â  Â  const confetti = document.getElementById('goalConfetti');

Â  Â  Â  Â  if (!target || target === 0) {
Â  Â  Â  Â  Â  Â  bar.style.width = '0%';
Â  Â  Â  Â  Â  Â  bar.innerText = 'ëª©í‘œë¥¼ ì…ë ¥í•˜ì„¸ìš”';
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  let percent = Math.min(100, Math.round((current / target) * 100));
Â  Â  Â  Â  bar.style.width = percent + '%';
Â  Â  Â  Â  bar.innerText = percent + '% ë‹¬ì„±';

Â  Â  Â  Â  if (percent >= 100) {
Â  Â  Â  Â  Â  Â  bar.style.background = 'linear-gradient(90deg, #10b981, #6ee7b7)';
Â  Â  Â  Â  Â  Â  confetti.style.display = 'block';
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  bar.style.background = 'linear-gradient(90deg, #a2c2ff, #95e1d3)';
Â  Â  Â  Â  Â  Â  confetti.style.display = 'none';
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // --- [ì„±ê³¼ ë¹„êµ ê¸°ëŠ¥] ---
Â  Â  function openCompareModal() {
Â  Â  Â  Â  if(monthList.size < 2) { alert("ë¹„êµí•  ë°ì´í„°ê°€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ (2ê°œì›” ì´ìƒ í•„ìš”)"); return; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const selA = document.getElementById('compA');
Â  Â  Â  Â  const selB = document.getElementById('compB');
Â  Â  Â  Â  selA.innerHTML = ''; selB.innerHTML = '';
Â  Â  Â  Â Â 
Â  Â  Â  Â  let list = Array.from(monthList).sort().reverse();
Â  Â  Â  Â  list.forEach(m => {
Â  Â  Â  Â  Â  Â  selA.innerHTML += `<option value="${m}">${m}</option>`;
Â  Â  Â  Â  Â  Â  selB.innerHTML += `<option value="${m}">${m}</option>`;
Â  Â  Â  Â  });
Â  Â  Â  Â  if(list.length >= 2) selB.selectedIndex = 1;Â 

Â  Â  Â  Â  document.getElementById('compareModal').style.display = 'flex';
Â  Â  Â  Â  document.getElementById('compareResult').style.display = 'none';
Â  Â  }

Â  Â  function doCompare() {
Â  Â  Â  Â  const mA = document.getElementById('compA').value;
Â  Â  Â  Â  const mB = document.getElementById('compB').value;
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(mA === mB) { alert("ì„œë¡œ ë‹¤ë¥¸ ë‹¬ì„ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }

Â  Â  Â  Â  const dataA = db.filter(i => i.month === mA && !i.isFullCancel);
Â  Â  Â  Â  const dataB = db.filter(i => i.month === mB && !i.isFullCancel);

Â  Â  Â  Â  const sumA = dataA.reduce((sum, i) => sum + i.price, 0);
Â  Â  Â  Â  const sumB = dataB.reduce((sum, i) => sum + i.price, 0);
Â  Â  Â  Â  const diff = sumA - sumB;

Â  Â  Â  Â  document.getElementById('compLabelA').innerText = mA + 'ì›” ë§¤ì¶œ';
Â  Â  Â  Â  document.getElementById('compLabelB').innerText = mB + 'ì›” ë§¤ì¶œ';
Â  Â  Â  Â  document.getElementById('compValA').innerText = sumA.toLocaleString() + 'ì›';
Â  Â  Â  Â  document.getElementById('compValB').innerText = sumB.toLocaleString() + 'ì›';
Â  Â  Â  Â Â 
Â  Â  Â  Â  const diffEl = document.getElementById('compDiff');
Â  Â  Â  Â  diffEl.innerText = (diff > 0 ? 'â–² ' : 'â–¼ ') + Math.abs(diff).toLocaleString() + 'ì›';
Â  Â  Â  Â  diffEl.className = diff > 0 ? 'delta-pos' : 'delta-neg';

Â  Â  Â  Â  document.getElementById('compareResult').style.display = 'block';

Â  Â  Â  Â  let ctx = document.getElementById('chartCompare').getContext('2d');
Â  Â  Â  Â  if(Chart.getChart('chartCompare')) Chart.getChart('chartCompare').destroy();
Â  Â  Â  Â  new Chart(ctx, {
Â  Â  Â  Â  Â  Â  type: 'bar',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  labels: ['ë§¤ì¶œì•¡'],
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: mA, data: [sumA], backgroundColor: '#a2c2ff' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: mB, data: [sumB], backgroundColor: '#ffb7b2' }
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: { responsive:true, maintainAspectRatio:false, scales: { y: { beginAtZero: true } } }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- [ìë™ ë³´ê³ ì„œ ìƒì„± ê¸°ëŠ¥] ---
Â  Â  function generateReport() {
Â  Â  Â  Â  const mon = document.getElementById('monthFilter').value;
Â  Â  Â  Â  if(mon === 'all') { alert("íŠ¹ì • ì›”ì„ ì„ íƒí•œ í›„ ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”."); return; }

Â  Â  Â  Â  let txt = `[ ğŸ“¢ ${mon}ì›” ì•„ì¹´ë°ë¯¸ ìš´ì˜ ì„±ê³¼ ë³´ê³  ]\n\n`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  txt += `1. ë§¤ì¶œ ìš”ì•½\n`;
Â  Â  Â  Â  txt += `- ì´ ë§¤ì¶œì•¡: ${currentKpi.amt.toLocaleString()}ì›\n`;
Â  Â  Â  Â  txt += `- ê²°ì œ ê±´ìˆ˜: ${currentKpi.cnt}ê±´\n`;
Â  Â  Â  Â  txt += `- ê°ë‹¨ê°€: ${document.getElementById('insightArpu').innerText}\n\n`;

Â  Â  Â  Â  txt += `2. ìˆ˜ê°•ìƒ í˜„í™©\n`;
Â  Â  Â  Â  txt += `- ì‹ ê·œ ìœ ì…: ${document.getElementById('insightNew').innerText}\n`;
Â  Â  Â  Â  txt += `- ì¬ë“±ë¡ë¥ : ${document.getElementById('insightRetention').innerText}\n`;
Â  Â  Â  Â  txt += `- ì´íƒˆ ì˜ì‹¬: ${document.getElementById('insightChurn').innerText} (ì¬ë“±ë¡ ë…ë ¤ í•„ìš”)\n\n`;

Â  Â  Â  Â  let classSums = {};
Â  Â  Â  Â  filteredDb.forEach(i => { if(!i.isFullCancel && i.type) classSums[i.type] = (classSums[i.type]||0)+i.price; });
Â  Â  Â  Â  let topClass = Object.keys(classSums).sort((a,b) => classSums[b]-classSums[a])[0] || 'ì—†ìŒ';
Â  Â  Â  Â Â 
Â  Â  Â  Â  txt += `3. ì£¼ìš” ì‚¬í•­\n`;
Â  Â  Â  Â  txt += `- ì´ë²ˆ ë‹¬ íš¨ì ìƒí’ˆ(ìœ í˜•)ì€ '${topClass}' ì…ë‹ˆë‹¤.\n`;
Â  Â  Â  Â  txt += `- í™˜ë¶ˆ ê±´ìˆ˜ëŠ” ì´ ${currentKpi.cancelCnt}ê±´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n`;

Â  Â  Â  Â  if(freeUserDb.length > 0) {
Â  Â  Â  Â  Â  Â  txt += `\n4. ë¬´ë£Œì²´í—˜ ì „í™˜ìœ¨\n`;
Â  Â  Â  Â  Â  Â  txt += `- ì´ ì²´í—˜ ì¸ì›: ${document.getElementById('convTotal').innerText}\n`;
Â  Â  Â  Â  Â  Â  txt += `- ìœ ë£Œ ì „í™˜: ${document.getElementById('convSuccess').innerText} (${document.getElementById('convRate').innerText})\n`;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(keyboardDb.length > 0) {
Â  Â  Â  Â  Â  Â  Â txt += `\n5. í‚¤ë³´ë“œ êµ¬ë§¤ì ë¶„ì„\n`;
Â  Â  Â  Â  Â  Â  Â txt += `- êµ¬ë§¤ì ì¤‘ ìˆ˜ê°•ì „í™˜: ${document.getElementById('kbRate').innerText}\n`;
Â  Â  Â  Â  Â  Â  Â txt += `- í‰ê·  ë“±ë¡ ì†Œìš”: ${document.getElementById('kbAvgDays').innerText}\n`;
Â  Â  Â  Â  }

Â  Â  Â  Â  document.getElementById('reportText').value = txt;
Â  Â  Â  Â  document.getElementById('reportModal').style.display = 'flex';
Â  Â  }

Â  Â  function copyReport() {
Â  Â  Â  Â  const el = document.getElementById('reportText');
Â  Â  Â  Â  el.select();
Â  Â  Â  Â  document.execCommand('copy');
Â  Â  Â  Â  alert("ë³´ê³ ì„œ ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
Â  Â  }

Â  Â  // --- [ê¸°ì¡´ ì°¨íŠ¸ ë Œë”ë§ í•¨ìˆ˜ë“¤] ---
Â  Â  function addCnt(obj, key, item) {
Â  Â  Â  Â  if(!key) return;
Â  Â  Â  Â  if(!obj[key]) obj[key] = {amt:0, cnt:0, list:[]};
Â  Â  Â  Â  obj[key].amt += item.price;
Â  Â  Â  Â  obj[key].cnt++;
Â  Â  Â  Â  obj[key].list.push(item);
Â  Â  }

Â  Â  function renderTrend() {
Â  Â  Â  Â  let monthly = {};
Â  Â  Â  Â  db.forEach(i => { if(!i.isFullCancel) monthly[i.month] = (monthly[i.month]||0) + i.price; });
Â  Â  Â  Â  let keys = Object.keys(monthly).sort();
Â  Â  Â  Â  let vals = keys.map(k => monthly[k]);
Â  Â  Â  Â  let ctx = document.getElementById('chartTrend').getContext('2d');
Â  Â  Â  Â  if(Chart.getChart('chartTrend')) Chart.getChart('chartTrend').destroy();
Â  Â  Â  Â  new Chart(ctx, {
Â  Â  Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  Â  Â  data: { labels: keys, datasets: [{Â 
Â  Â  Â  Â  Â  Â  Â  Â  label:'ì›”ë§¤ì¶œ', data:vals,Â 
Â  Â  Â  Â  Â  Â  Â  Â  borderColor:'#8cb6ff', backgroundColor:'rgba(162, 194, 255, 0.2)',
Â  Â  Â  Â  Â  Â  Â  Â  pointBackgroundColor: '#fff', pointBorderColor: '#8cb6ff', pointRadius: 5,
Â  Â  Â  Â  Â  Â  Â  Â  fill:true, tension: 0.3Â 
Â  Â  Â  Â  Â  Â  }] },
Â  Â  Â  Â  Â  Â  options: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  responsive:true, maintainAspectRatio:false,
Â  Â  Â  Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  x: { grid: { display: false } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: { grid: { borderDash: [5, 5], color: '#f0f0f0' } }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function renderChart(id, obj, metric, isTimeSort=false, colors) {
Â  Â  Â  Â  // ê¸°ì¡´ ë¡œì§ ëŒ€ì‘: objê°€ í•¨ìˆ˜í˜•íƒœì¸ ê²½ìš°ë¥¼ ìœ„í•´ keys ì¶”ì¶œ
Â  Â  Â  Â  let keys = Object.keys(obj);
Â  Â  Â  Â  if(isTimeSort) keys.sort((a,b) => parseInt(a) - parseInt(b));
Â  Â  Â  Â  else keys.sort((a,b) => metric==='ë§¤ì¶œ'?obj[b].amt-obj[a].amt : obj[b].cnt-obj[a].cnt);

Â  Â  Â  Â  let vals = keys.map(k => metric==='ë§¤ì¶œ'?obj[k].amt : obj[k].cnt);
Â  Â  Â  Â  let ctx = document.getElementById(id).getContext('2d');
Â  Â  Â  Â  if(Chart.getChart(id)) Chart.getChart(id).destroy();
Â  Â  Â  Â  new Chart(ctx, {
Â  Â  Â  Â  Â  Â  type: metric==='ë§¤ì¶œ'?'doughnut':'bar',
Â  Â  Â  Â  Â  Â  data: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  labels: keys,Â 
Â  Â  Â  Â  Â  Â  Â  Â  datasets: [{Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  label:metric, data:vals,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backgroundColor: colors || ['#3b82f6','#10b981'],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: 5, borderWidth: 0
Â  Â  Â  Â  Â  Â  Â  Â  }]Â 
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  options: {Â 
Â  Â  Â  Â  Â  Â  Â  Â  responsive:true, maintainAspectRatio:false,
Â  Â  Â  Â  Â  Â  Â  Â  onClick: (e, els) => { if(els.length>0) showList(keys[els[0].index], 'list', obj[keys[els[0].index]].list); },
Â  Â  Â  Â  Â  Â  Â  Â  scales: metric==='ë§¤ì¶œ' ? {} : {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  x: { grid: { display: false } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: { grid: { borderDash: [5, 5], color: '#f0f0f0' } }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function renderTable(id, obj, metric, isTimeSort=false) {
Â  Â  Â  Â  let tb = document.querySelector(`#${id} tbody`);
Â  Â  Â  Â  tb.innerHTML = '';
Â  Â  Â  Â  let keys = Object.keys(obj);
Â  Â  Â  Â  if(isTimeSort) keys.sort((a,b) => parseInt(a) - parseInt(b));
Â  Â  Â  Â  else keys.sort((a,b) => metric==='ë§¤ì¶œ'?obj[b].amt-obj[a].amt : obj[b].cnt-obj[a].cnt);
Â  Â  Â  Â  keys.forEach(k => {
Â  Â  Â  Â  Â  Â  let tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  let val = metric==='ë§¤ì¶œ'?obj[k].amt.toLocaleString()+'ì›' : obj[k].cnt+'ëª…';
Â  Â  Â  Â  Â  Â  tr.innerHTML = metric==='ë§¤ì¶œ' ? `<td>${k}</td><td>${val}</td><td>${obj[k].cnt}ê±´</td><td class="clickable-row">í™•ì¸</td>` : `<td>${k}</td><td>${val}</td><td class="clickable-row">í™•ì¸</td>`;
Â  Â  Â  Â  Â  Â  tr.onclick = () => showList(k, 'list', obj[k].list);
Â  Â  Â  Â  Â  Â  tb.appendChild(tr);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function renderHeatmap(hm) {
Â  Â  Â  Â  const times = [9,10,11,14,15,16,17,19,20,21];
Â  Â  Â  Â  const days = ['ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† ','ì¼'];
Â  Â  Â  Â  let html = '<table class="heatmap-table"><thead><tr><th></th>';
Â  Â  Â  Â  times.forEach(t=>html+=`<th>${t}</th>`);
Â  Â  Â  Â  html+='</tr></thead><tbody>';
Â  Â  Â  Â  let max = 0;
Â  Â  Â  Â  days.forEach(d=>times.forEach(t=>{ if(hm[d][t] && hm[d][t].cnt>max) max = hm[d][t].cnt; }));
Â  Â  Â  Â  days.forEach(d=>{
Â  Â  Â  Â  Â  Â  html+=`<tr><th>${d}</th>`;
Â  Â  Â  Â  Â  Â  times.forEach(t=>{
Â  Â  Â  Â  Â  Â  Â  Â  let cnt = hm[d][t] ? hm[d][t].cnt : 0;
Â  Â  Â  Â  Â  Â  Â  Â  let alpha = max > 0 ? cnt/max : 0;
Â  Â  Â  Â  Â  Â  Â  Â  let bg = cnt>0 ? `rgba(255, 183, 178, ${Math.max(0.15, alpha)})` : '#fdfdfd';
Â  Â  Â  Â  Â  Â  Â  Â  let col = (alpha > 0.6) ? '#fff' : '#666';
Â  Â  Â  Â  Â  Â  Â  Â  let border = cnt>0 ? 'border:1px solid #ffdeda;' : '';
Â  Â  Â  Â  Â  Â  Â  Â  html+=`<td class="heatmap-cell" style="background:${bg};color:${col};${border}" onclick='showList("${d} ${t}ì‹œ","list", ${JSON.stringify(hm[d][t]?hm[d][t].list:[])})'>${cnt||'-'}</td>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  html+='</tr>';
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('heatmapArea').innerHTML = html+'</tbody></table>';
Â  Â  }

Â  Â  function renderVip(stu) {
Â  Â  Â  Â  let list = Object.values(stu).sort((a,b)=>b.amt-a.amt).slice(0,10);
Â  Â  Â  Â  let tb = document.querySelector('#tableVip tbody');
Â  Â  Â  Â  tb.innerHTML = '';
Â  Â  Â  Â  list.forEach((s,i)=>{
Â  Â  Â  Â  Â  Â  let tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  tr.innerHTML = `<td><span class="rank-badge ${i<3?'rank-'+(i+1):''}">${i+1}</span></td><td style="font-weight:bold;">${s.name}</td><td>${s.amt.toLocaleString()}</td><td>${s.cnt}</td><td class="clickable-row">í™•ì¸</td>`;
Â  Â  Â  Â  Â  Â  tr.onclick = () => showList(s.name, 'list', s.list);
Â  Â  Â  Â  Â  Â  tb.appendChild(tr);
Â  Â  Â  Â  });
Â  Â  Â  Â  let rev = Object.values(stu).filter(s=>s.cnt>=2).sort((a,b)=>b.cnt-a.cnt).slice(0,10);
Â  Â  Â  Â  let tb2 = document.querySelector('#tableRevisit tbody');
Â  Â  Â  Â  tb2.innerHTML = '';
Â  Â  Â  Â  rev.forEach(s=>{
Â  Â  Â  Â  Â  Â  let tr = document.createElement('tr');
Â  Â  Â  Â  Â  Â  tr.innerHTML = `<td>${s.name}</td><td>${s.phone}</td><td>${s.cnt}íšŒ</td><td>${s.amt.toLocaleString()}</td><td class="clickable-row">í™•ì¸</td>`;
Â  Â  Â  Â  Â  Â  tr.onclick = () => showList(s.name, 'list', s.list);
Â  Â  Â  Â  Â  Â  tb2.appendChild(tr);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function showList(title, type, list=[]) {
Â  Â  Â  Â  let tList = list;
Â  Â  Â  Â  if(type==='valid_sales') tList = filteredDb.filter(i=>!i.isFullCancel);
Â  Â  Â  Â  if(type==='full_cancel') tList = filteredDb.filter(i=>i.isFullCancel);
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('modalTitle').innerText = `${title} (${tList.length}ëª…)`;
Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  tList.forEach(i=>{
Â  Â  Â  Â  Â  Â  let badge = i.isPartial ? '<span class="badge-partial">ì¤‘ë„í™˜ë¶ˆ</span>' : '';
Â  Â  Â  Â  Â  Â  html += `<div class="student-item">
Â  Â  Â  Â  Â  Â  Â  Â  <div><b>${i.name}</b> ${badge} <span style="color:#888;font-size:12px">${i.product} (${i.price.toLocaleString()}ì›)</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>${i.phone} <span style="font-size:11px;color:#aaa">${i.date}</span></div>
Â  Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('modalList').innerHTML = html;
Â  Â  Â  Â  document.getElementById('studentModal').style.display = 'flex';
Â  Â  }
Â  Â Â 
Â  Â  function showInsightList(title, type) {
Â  Â  Â  Â  let list = (type === 'new') ? newList : churnList;
Â  Â  Â  Â  showList(title, 'list', list);
Â  Â  }

Â  Â  function copyList() {
Â  Â  Â  Â  let txt = "";
Â  Â  Â  Â  document.querySelectorAll('.student-item').forEach(div=>{
Â  Â  Â  Â  Â  Â  txt += `${div.children[0].innerText}\t${div.children[1].innerText}\n`;
Â  Â  Â  Â  });
Â  Â  Â  Â  navigator.clipboard.writeText(txt).then(()=>alert('ëª…ë‹¨ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì—‘ì…€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”!'));
Â  Â  }
</script>
</body>
</html>


ì €ë ‡ê²Œ ìƒê¸´ í˜•ì‹ì˜ ì—‘ì…€ë„ ì½ì–´ë‚¼ ìˆ˜ ìˆì—ˆìœ¼ë©´ ì¢‹ê² ì–´
